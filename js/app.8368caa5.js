(function(){"use strict";var e={719:function(e,t,a){var s=a(5130),n=a(6768);const o={id:"app"};function r(e,t,a,s,r,i){const l=(0,n.g2)("CardSearch");return(0,n.uX)(),(0,n.CE)("div",o,[(0,n.bF)(l)])}var i=a(4232);const l={class:"card-search-container"},c=["src"],d={class:"main-content"},u={class:"search-controls"},m={class:"search-box-wrapper"},p={class:"search-box"},h={class:"results-area"},k={key:1,class:"no-results"},g={key:2,class:"pagination-container"},C={class:"pagination-controls"},v=["disabled"],f={class:"page-number"},y=["disabled"];function b(e,t,o,r,b,L){const x=(0,n.g2)("CardAutocomplete"),D=(0,n.g2)("FilterPopup"),w=(0,n.g2)("CardGrid"),E=(0,n.g2)("DeckSidebar"),S=(0,n.g2)("CardDetailsPopup");return(0,n.uX)(),(0,n.CE)("div",l,[(0,n.Lk)("img",{src:a(726),alt:"Deckmoor",class:"deckmoor-logo"},null,8,c),(0,n.Lk)("div",d,[(0,n.Lk)("div",u,[(0,n.Lk)("div",m,[(0,n.Lk)("div",p,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>b.query=e),onInput:t[1]||(t[1]=(...e)=>L.debouncedSearch&&L.debouncedSearch(...e)),onKeyup:t[2]||(t[2]=(0,s.jR)(((...e)=>L.submitSearch&&L.submitSearch(...e)),["enter"])),placeholder:"Search cards...",class:"search-input"},null,544),[[s.Jo,b.query]]),(0,n.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>L.submitSearch&&L.submitSearch(...e)),class:"search-button"},t[10]||(t[10]=[(0,n.Lk)("i",{class:"fas fa-search"},null,-1),(0,n.eW)(" Search ")]))]),b.results?.length>0?((0,n.uX)(),(0,n.Wv)(x,{key:0,results:b.results,onSelectCard:L.showCardDetails},null,8,["results","onSelectCard"])):(0,n.Q3)("",!0)]),(0,n.Lk)("button",{onClick:t[4]||(t[4]=e=>b.showFilterPopup=!0),class:"filter-button"},t[11]||(t[11]=[(0,n.Lk)("i",{class:"fas fa-filter"},null,-1),(0,n.eW)(" Advanced Options ")]))]),b.showFilterPopup?((0,n.uX)(),(0,n.Wv)(D,{key:0,isOpen:b.showFilterPopup,allSets:b.allSets,currentFilters:b.activeFilters,onClosePopup:t[5]||(t[5]=e=>b.showFilterPopup=!1),onApplyFilters:L.handleApplyFilters},null,8,["isOpen","allSets","currentFilters","onApplyFilters"])):(0,n.Q3)("",!0),(0,n.Lk)("div",h,[b.cards&&b.cards.length>0?((0,n.uX)(),(0,n.Wv)(w,{key:0,cards:b.cards,onSelectCard:L.showCardDetails,onAddToDeck:L.addCardToDeck},null,8,["cards","onSelectCard","onAddToDeck"])):(0,n.Q3)("",!0),!b.hasSearched||b.cards&&0!==b.cards.length?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",k," No cards found matching your criteria ")),(b.hasMore||b.page>1)&&b.cards.length?((0,n.uX)(),(0,n.CE)("div",g,[(0,n.Lk)("div",C,[(0,n.Lk)("button",{onClick:t[6]||(t[6]=e=>L.fetchCards(b.page-1)),disabled:1===b.page,class:"pagination-button"}," < Previous ",8,v),(0,n.Lk)("span",f,"Page "+(0,i.v_)(b.page),1),(0,n.Lk)("button",{onClick:t[7]||(t[7]=e=>L.fetchCards(b.page+1)),disabled:!b.hasMore,class:"pagination-button"}," Next > ",8,y)])])):(0,n.Q3)("",!0)])]),(0,n.bF)(E,{ref:"deckSidebar",selectedCard:b.selectedCard,onResetSelectedCard:t[8]||(t[8]=e=>b.selectedCard=null),onViewCard:L.showCardDetails,onDeckSaved:L.onDeckSaved},null,8,["selectedCard","onViewCard","onDeckSaved"]),b.selectedCard?((0,n.uX)(),(0,n.Wv)(S,{key:0,card:b.selectedCard,onClose:t[9]||(t[9]=e=>b.selectedCard=null),onAddToDeck:L.addCardToDeck},null,8,["card","onAddToDeck"])):(0,n.Q3)("",!0)])}var L=a(4373),x=a(896),D=a.n(x);const w=["onClick"],E={class:"card-result"},S={class:"card-name"},I=["innerHTML"];function T(e,t,a,o,r,l){return a.results?.length>0?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"autocomplete-dropdown",onClick:t[0]||(t[0]=(0,s.D$)((()=>{}),["stop"]))},[(0,n.Lk)("ul",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.results,(t=>((0,n.uX)(),(0,n.CE)("li",{key:t.id,onClick:a=>e.$emit("select-card",t)},[(0,n.Lk)("div",E,[(0,n.Lk)("span",S,(0,i.v_)(t.name),1),t.mana_cost?((0,n.uX)(),(0,n.CE)("span",{key:0,class:"card-mana-cost",innerHTML:l.formatManaCost(t.mana_cost)},null,8,I)):(0,n.Q3)("",!0)])],8,w)))),128))])])):(0,n.Q3)("",!0)}var _={name:"CardAutocomplete",props:{results:Array},methods:{closeDropdown(){this.$emit("select-card",null)},formatManaCost(e){return e?e.replace(/\{([^}]+)\}/g,((e,t)=>{let a=t.toLowerCase();return"t"!==a&&"tap"!==a||(a="tap"),"q"!==a&&"untap"!==a||(a="untap"),a.includes("/")&&(a=a.replace("/","")),`<span class="mana s${a}"></span>`})):""}},mounted(){document.addEventListener("click",this.closeDropdown)},beforeUnmount(){document.removeEventListener("click",this.closeDropdown)}},$=a(1241);const F=(0,$.A)(_,[["render",T],["__scopeId","data-v-37b39bc6"]]);var M=F;const X={class:"card-grid"},P={class:"card-item"},O=["src","alt","onClick"],A={class:"card-title"},Q=["onClick"];function Z(e,t,a,o,r,l){return(0,n.uX)(),(0,n.CE)("div",X,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.cards,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:"card-container"},[(0,n.Lk)("div",P,[(0,n.Lk)("img",{src:l.getCardImageUrl(e),alt:e.name,class:"card-image",onClick:t=>l.handleImageClick(e)},null,8,O),(0,n.Lk)("div",A,(0,i.v_)(e.name),1),(0,n.Lk)("button",{class:"add-to-deck-btn",onClick:(0,s.D$)((t=>l.handleAddToDeck(e)),["stop"]),title:"Add to deck"},t[0]||(t[0]=[(0,n.Lk)("span",{class:"plus-icon"},"+",-1)]),8,Q)])])))),128))])}var N={props:{cards:{type:Array,required:!0}},methods:{getCardImageUrl(e){return e.card_faces&&e.card_faces.length>0&&e.card_faces[0].image_uris?e.card_faces[0].image_uris.normal:e.image_uris&&e.image_uris.normal?e.image_uris.normal:"placeholder-image.jpg"},handleAddToDeck(e){console.log("Add button clicked for:",e.name),this.$emit("add-to-deck",e)},handleImageClick(e){this.$emit("select-card",e)}}};const R=(0,$.A)(N,[["render",Z],["__scopeId","data-v-a3dca27e"]]);var B=R;const H={class:"popup-content"},U={class:"popup-body"},j={class:"card-image-container"},J={class:"card-image"},z={key:0,class:"flip-hint"},K={class:"card-info"},W={class:"card-title"},q={class:"info-grid"},V={class:"info-row"},G=["innerHTML"],Y={class:"info-row"},ee={class:"info-value"},te={key:0,class:"info-row"},ae={class:"info-value"},se={class:"info-row"},ne={class:"info-value"},oe={key:1,class:"info-row"},re={class:"info-value"},ie={class:"oracle-text"},le=["innerHTML"];function ce(e,t,a,o,r,l){const c=(0,n.g2)("CardFlip");return(0,n.uX)(),(0,n.CE)("div",{class:"popup-overlay",onClick:t[2]||(t[2]=(0,s.D$)(((...e)=>l.close&&l.close(...e)),["self"]))},[(0,n.Lk)("div",H,[(0,n.Lk)("button",{class:"close-button",onClick:t[0]||(t[0]=(...e)=>l.close&&l.close(...e)),"aria-label":"Close popup"},"×"),(0,n.Lk)("div",U,[(0,n.Lk)("div",j,[(0,n.Lk)("div",J,[(0,n.bF)(c,{card:a.card},null,8,["card"]),l.canBeFlipped?((0,n.uX)(),(0,n.CE)("div",z,"Click to flip")):(0,n.Q3)("",!0)]),(0,n.Lk)("button",{class:"add-to-deck-btn",onClick:t[1]||(t[1]=(...e)=>l.addToDeckAndClose&&l.addToDeckAndClose(...e))}," Add to Deck ")]),(0,n.Lk)("div",K,[(0,n.Lk)("h2",W,(0,i.v_)(a.card.name),1),(0,n.Lk)("div",q,[(0,n.Lk)("div",V,[t[3]||(t[3]=(0,n.Lk)("span",{class:"info-label"},"Mana Cost:",-1)),(0,n.Lk)("span",{class:"info-value mana-symbols",innerHTML:l.formatManaCost(l.displayManaCost)},null,8,G)]),(0,n.Lk)("div",Y,[t[4]||(t[4]=(0,n.Lk)("span",{class:"info-label"},"Color Identity:",-1)),(0,n.Lk)("span",ee,(0,i.v_)(l.formatColorIdentity(a.card.colors)),1)]),a.card.power||a.card.toughness?((0,n.uX)(),(0,n.CE)("div",te,[t[5]||(t[5]=(0,n.Lk)("span",{class:"info-label"},"Power/Toughness:",-1)),(0,n.Lk)("span",ae,(0,i.v_)(a.card.power&&a.card.toughness?`${a.card.power}/${a.card.toughness}`:"N/A"),1)])):(0,n.Q3)("",!0),(0,n.Lk)("div",se,[t[6]||(t[6]=(0,n.Lk)("span",{class:"info-label"},"Type:",-1)),(0,n.Lk)("span",ne,(0,i.v_)(a.card.type_line),1)]),a.card.set_name?((0,n.uX)(),(0,n.CE)("div",oe,[t[7]||(t[7]=(0,n.Lk)("span",{class:"info-label"},"Set:",-1)),(0,n.Lk)("span",re,(0,i.v_)(a.card.set_name),1)])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",ie,[t[8]||(t[8]=(0,n.Lk)("h3",null,"Oracle Text",-1)),(0,n.Lk)("p",{innerHTML:l.formatManaCost(l.displayOracleText)},null,8,le)])])])])])}a(8992),a(4520),a(1454);const de={class:"card-face front"},ue=["src","alt"],me={class:"card-face back"},pe=["src","alt"];function he(e,t,a,s,o,r){return(0,n.uX)(),(0,n.CE)("div",{class:"card-flip-container",onClick:t[0]||(t[0]=(...e)=>r.flipCard&&r.flipCard(...e))},[(0,n.Lk)("div",{class:(0,i.C4)(["card-flip",{flipped:o.isFlipped}])},[(0,n.Lk)("div",de,[(0,n.Lk)("img",{src:r.frontImage||"/placeholder.jpg",alt:a.card.name},null,8,ue)]),(0,n.Lk)("div",me,[(0,n.Lk)("img",{src:r.backImage||"/placeholder.jpg",alt:a.card.name},null,8,pe)])],2)])}var ke={props:{card:Object},data(){return{isFlipped:!1}},computed:{frontImage(){return this.card?.card_faces?.[0]?.image_uris?.normal||this.card?.image_uris?.normal},backImage(){return this.card?.card_faces?.[1]?.image_uris?.normal||null}},methods:{flipCard(){this.backImage&&(this.isFlipped=!this.isFlipped)}}};const ge=(0,$.A)(ke,[["render",he],["__scopeId","data-v-06047df8"]]);var Ce=ge,ve={props:{card:Object},components:{CardFlip:Ce},mounted(){},computed:{canBeFlipped(){return Boolean(this.card?.card_faces?.[1]?.image_uris?.normal)},displayManaCost(){if(this.card.card_faces?.length){const[e,t]=this.card.card_faces,a=e.mana_cost||"",s=t?.mana_cost||"";return a&&s?`${a} // ${s}`:a||s||"N/A"}return this.card.mana_cost||"N/A"},displayOracleText(){return this.card.card_faces?.length?this.card.card_faces.map((e=>e.oracle_text||"")).filter(Boolean).join('<hr style="margin: 10px 0;">'):this.card.oracle_text||"N/A"}},methods:{close(){this.$emit("close")},addToDeckAndClose(){console.log("Emitting add-to-deck for:",this.card.name),this.$emit("add-to-deck",this.card),this.close()},formatManaCost(e){return e?e.replace(/\{([^}]+)\}/g,((e,t)=>{let a=t.toLowerCase();return"t"===a||"tap"===a?a="t":"q"===a||"untap"===a?a="q":a.includes("/")?a=a.replace("/",""):/^\d+$/.test(a)&&(a=t),`<span class="mana medium s${a}"></span>`})):"N/A"},formatColorIdentity(e){if(!e||0===e.length)return"Colorless";const t={W:"White",U:"Blue",B:"Black",R:"Red",G:"Green"};return e.map((e=>t[e]||e)).join(", ")}}};const fe=(0,$.A)(ve,[["render",ce],["__scopeId","data-v-4c259fe0"]]);var ye=fe;const be={class:"filter-popup"},Le={class:"popup-header"},xe={class:"popup-content"},De={class:"filter-section"},we={class:"set-selector"},Ee={class:"set-list"},Se=["value"],Ie={class:"set-name"},Te={class:"set-code"},_e={class:"filter-section"},$e={class:"color-buttons"},Fe=["onClick","title"],Me={class:"filter-section"},Xe={class:"rarity-buttons"},Pe=["onClick","title"],Oe=["src","alt"],Ae={class:"filter-section"},Qe={class:"type-buttons"},Ze=["onClick"],Ne={class:"filter-section"},Re={class:"supertype-buttons"},Be=["onClick"],He={class:"filter-section"},Ue={class:"mana-cost-filters"},je={class:"mana-cost-filter"},Je={class:"mana-cost-filter"},ze={class:"pt-filters"},Ke={class:"filter-section"},We={class:"value-filter"},qe={class:"filter-section"},Ve={class:"value-filter"},Ge={class:"popup-footer"};function Ye(e,t,a,o,r,l){return a.isOpen?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"popup-overlay",onClick:t[12]||(t[12]=(0,s.D$)(((...e)=>l.closePopup&&l.closePopup(...e)),["self"]))},[(0,n.Lk)("div",be,[(0,n.Lk)("div",Le,[t[13]||(t[13]=(0,n.Lk)("h3",null,"Card Filters",-1)),(0,n.Lk)("button",{class:"close-btn",onClick:t[0]||(t[0]=(...e)=>l.closePopup&&l.closePopup(...e))},"×")]),(0,n.Lk)("div",xe,[(0,n.Lk)("div",De,[t[14]||(t[14]=(0,n.Lk)("h4",null,"Set",-1)),(0,n.Lk)("div",we,[(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>r.setSearchQuery=e),placeholder:"Search sets...",onInput:t[2]||(t[2]=(...e)=>l.filterSets&&l.filterSets(...e)),class:"search-input"},null,544),[[s.Jo,r.setSearchQuery]]),(0,n.Lk)("div",Ee,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.filteredSets,(e=>((0,n.uX)(),(0,n.CE)("label",{key:e.code,class:"set-item"},[(0,n.bo)((0,n.Lk)("input",{type:"checkbox",value:e.code,"onUpdate:modelValue":t[3]||(t[3]=e=>r.filters.sets=e),class:"set-checkbox"},null,8,Se),[[s.lH,r.filters.sets]]),(0,n.Lk)("span",Ie,(0,i.v_)(e.name),1),(0,n.Lk)("span",Te,(0,i.v_)(e.code.toUpperCase()),1)])))),128))])])]),(0,n.Lk)("div",_e,[t[15]||(t[15]=(0,n.Lk)("h4",null,"Color",-1)),(0,n.Lk)("div",$e,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.colorOptions,(e=>((0,n.uX)(),(0,n.CE)("button",{key:e.code,class:(0,i.C4)(["color-btn",{selected:r.filters.colors.includes(e.code)}]),style:(0,i.Tr)({backgroundColor:e.background}),onClick:t=>l.toggleColor(e.code),title:e.name},[(0,n.Lk)("span",{class:(0,i.C4)(["mana small",`s${e.code.toLowerCase()}`])},null,2)],14,Fe)))),128))])]),(0,n.Lk)("div",Me,[t[16]||(t[16]=(0,n.Lk)("h4",null,"Rarity",-1)),(0,n.Lk)("div",Xe,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.rarityOptions,(e=>((0,n.uX)(),(0,n.CE)("button",{key:e.code,class:(0,i.C4)(["rarity-btn",e.code,{selected:r.filters.rarities.includes(e.code)}]),onClick:t=>l.toggleRarity(e.code),title:e.name},[(0,n.Lk)("img",{src:e.image,alt:e.name,class:"rarity-icon"},null,8,Oe)],10,Pe)))),128))])]),(0,n.Lk)("div",Ae,[t[17]||(t[17]=(0,n.Lk)("h4",null,"Card Type",-1)),(0,n.Lk)("div",Qe,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.typeOptions,(e=>((0,n.uX)(),(0,n.CE)("button",{key:e,class:(0,i.C4)(["type-btn",{selected:r.filters.types.includes(e)}]),onClick:t=>l.toggleType(e)},(0,i.v_)(e),11,Ze)))),128))])]),(0,n.Lk)("div",Ne,[t[18]||(t[18]=(0,n.Lk)("h4",null,"Supertype",-1)),(0,n.Lk)("div",Re,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.supertypeOptions,(e=>((0,n.uX)(),(0,n.CE)("button",{key:e,class:(0,i.C4)(["supertype-btn",{selected:r.filters.supertypes.includes(e)}]),onClick:t=>l.toggleSupertype(e)},(0,i.v_)(e),11,Be)))),128))])]),(0,n.Lk)("div",He,[t[21]||(t[21]=(0,n.Lk)("h4",null,"Mana Cost",-1)),(0,n.Lk)("div",Ue,[(0,n.Lk)("div",je,[t[19]||(t[19]=(0,n.Lk)("label",null,"Minimum:",-1)),(0,n.bo)((0,n.Lk)("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=e=>r.filters.manaCost.min=e),min:"0",max:"20",class:"mana-input"},null,512),[[s.Jo,r.filters.manaCost.min,void 0,{number:!0}]])]),(0,n.Lk)("div",Je,[t[20]||(t[20]=(0,n.Lk)("label",null,"Maximum:",-1)),(0,n.bo)((0,n.Lk)("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=e=>r.filters.manaCost.max=e),min:"0",max:"20",class:"mana-input"},null,512),[[s.Jo,r.filters.manaCost.max,void 0,{number:!0}]])])])]),(0,n.Lk)("div",ze,[(0,n.Lk)("div",Ke,[t[23]||(t[23]=(0,n.Lk)("h4",null,"Power",-1)),(0,n.Lk)("div",We,[(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>r.filters.power.operator=e),class:"operator-select"},t[22]||(t[22]=[(0,n.Lk)("option",{value:"="},"=",-1),(0,n.Lk)("option",{value:">"},"≥",-1),(0,n.Lk)("option",{value:"<"},"≤",-1)]),512),[[s.u1,r.filters.power.operator]]),(0,n.bo)((0,n.Lk)("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=e=>r.filters.power.value=e),min:"0",class:"value-input",placeholder:"0"},null,512),[[s.Jo,r.filters.power.value,void 0,{number:!0}]])])]),(0,n.Lk)("div",qe,[t[25]||(t[25]=(0,n.Lk)("h4",null,"Toughness",-1)),(0,n.Lk)("div",Ve,[(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>r.filters.toughness.operator=e),class:"operator-select"},t[24]||(t[24]=[(0,n.Lk)("option",{value:"="},"=",-1),(0,n.Lk)("option",{value:">"},"≥",-1),(0,n.Lk)("option",{value:"<"},"≤",-1)]),512),[[s.u1,r.filters.toughness.operator]]),(0,n.bo)((0,n.Lk)("input",{type:"number","onUpdate:modelValue":t[9]||(t[9]=e=>r.filters.toughness.value=e),min:"0",class:"value-input",placeholder:"0"},null,512),[[s.Jo,r.filters.toughness.value,void 0,{number:!0}]])])])])]),(0,n.Lk)("div",Ge,[(0,n.Lk)("button",{class:"clear-btn",onClick:t[10]||(t[10]=(...e)=>l.clearFilters&&l.clearFilters(...e))},t[26]||(t[26]=[(0,n.Lk)("i",{class:"fas fa-trash-alt"},null,-1),(0,n.eW)(" Clear All ")])),(0,n.Lk)("button",{class:"apply-btn",onClick:t[11]||(t[11]=(...e)=>l.applyFilters&&l.applyFilters(...e))},t[27]||(t[27]=[(0,n.Lk)("i",{class:"fas fa-check"},null,-1),(0,n.eW)(" Apply Filters ")]))])])])):(0,n.Q3)("",!0)}a(4114);var et={name:"FilterPopup",props:{allSets:{type:Array,default:()=>[]},isOpen:{type:Boolean,default:!1},currentFilters:{type:Object,default:()=>({sets:[],rarities:[],types:[],supertypes:[],colors:[],manaCost:{min:0,max:20},power:{operator:"=",value:null},toughness:{operator:"=",value:null}})}},data(){return{filters:JSON.parse(JSON.stringify(this.currentFilters)),setSearchQuery:"",filteredSets:this.allSets,manaCost:this.currentFilters.manaCost||{min:0,max:20},rarityOptions:[{code:"common",name:"Common",image:a(6526)},{code:"uncommon",name:"Uncommon",image:a(9767)},{code:"rare",name:"Rare",image:a(2377)},{code:"mythic",name:"Mythic Rare",image:a(4951)},{code:"special",name:"Timeshifted",image:a(311)},{code:"bonus",name:"Masterpiece",image:a(9905)}],typeOptions:["Artifact","Creature","Enchantment","Instant","Land","Planeswalker","Sorcery","Tribal"],supertypeOptions:["Basic","Legendary","Snow","World"],colorOptions:[{code:"W",name:"White",background:"#f8f5e4"},{code:"U",name:"Blue",background:"#c0d8e8"},{code:"B",name:"Black",background:"#cbc2bf"},{code:"R",name:"Red",background:"#e8b8a0"},{code:"G",name:"Green",background:"#c8d6c2"},{code:"C",name:"Colorless",background:"#e8e8e8"}]}},watch:{allSets:{handler(e){this.filteredSets=e},immediate:!0},currentFilters:{handler(e){this.filters=JSON.parse(JSON.stringify(e))},deep:!0}},methods:{filterSets(){if(this.setSearchQuery.trim()){const e=this.setSearchQuery.toLowerCase();this.filteredSets=this.allSets.filter((t=>t.name.toLowerCase().includes(e)||t.code.toLowerCase().includes(e)))}else this.filteredSets=this.allSets},toggleRarity(e){const t=this.filters.rarities.indexOf(e);-1===t?this.filters.rarities.push(e):this.filters.rarities.splice(t,1)},toggleColor(e){const t=this.filters.colors.indexOf(e);-1===t?this.filters.colors.push(e):this.filters.colors.splice(t,1)},toggleType(e){const t=this.filters.types.indexOf(e);-1===t?this.filters.types.push(e):this.filters.types.splice(t,1)},toggleSupertype(e){const t=this.filters.supertypes.indexOf(e);-1===t?this.filters.supertypes.push(e):this.filters.supertypes.splice(t,1)},applyFilters(){this.$emit("apply-filters",JSON.parse(JSON.stringify(this.filters))),this.closePopup()},clearFilters(){this.filters={sets:[],rarities:[],types:[],supertypes:[],colors:[],manaCost:{min:0,max:20},power:{operator:"=",value:null},toughness:{operator:"=",value:null}},this.setSearchQuery="",this.filteredSets=this.allSets,this.$emit("clear-filters")},closePopup(){this.$emit("close-popup")}}};const tt=(0,$.A)(et,[["render",Ye],["__scopeId","data-v-0a6204ae"]]);var at=tt;const st={class:"deck-sidebar"},nt={key:0,class:"sync-time"},ot={key:0,class:"deck-list"},rt={class:"sidebar-header"},it={class:"deck-items-container"},lt=["onClick"],ct={class:"deck-name"},dt=["innerHTML"],ut={key:0,class:"deck-warning"},mt=["onClick"],pt={class:"deck-buttons-container"},ht={key:1,class:"active-deck"},kt={class:"deck-header"},gt={class:"deck-header-top"},Ct={class:"deck-title-section"},vt={class:"title-wrapper"},ft={class:"title-container"},yt={key:0,class:"deck-title"},bt={key:1,class:"rename-input-wrapper"},Lt={class:"title-actions"},xt={class:"deck-meta-row"},Dt={class:"deck-meta"},wt=["innerHTML"],Et={class:"deck-header-actions"},St={key:0,class:"commander-section"},It=["src","alt"],Tt={class:"commander-name"},_t={class:"deck-cards"},$t=["data-invalid-reason","onClick"],Ft={class:"card-info"},Mt={class:"card-header"},Xt={class:"card-name"},Pt={class:"card-actions"},Ot=["onClick"],At=["onClick"],Qt={class:"deck-actions"},Zt={class:"modal-content"},Nt={class:"form-group"},Rt={class:"form-group"},Bt={key:0,class:"selected-commander"},Ht={class:"commander-preview"},Ut=["src","alt"],jt={class:"selected-card-name"},Jt={class:"modal-actions"},zt=["disabled"],Kt={class:"modal-content commander-search"},Wt={class:"search-box"},qt={class:"commander-results"},Vt=["onClick"],Gt=["src","alt"],Yt={class:"search-result-name"},ea={class:"modal-actions"},ta={class:"modal-content"},aa={class:"modal-actions"};function sa(e,t,a,o,r,l){const c=(0,n.g2)("StatsPopup"),d=(0,n.g2)("ImportPopup"),u=(0,n.g2)("ExportPopup"),m=(0,n.g2)("PlaytestPopup");return(0,n.uX)(),(0,n.CE)("div",st,[(0,n.Lk)("div",{class:(0,i.C4)(["connection-status",r.firebaseStatus])},[t[32]||(t[32]=(0,n.Lk)("span",{class:"status-icon"},null,-1)),(0,n.eW)(" "+(0,i.v_)(l.statusMessage)+" ",1),r.lastSyncTime?((0,n.uX)(),(0,n.CE)("span",nt,"("+(0,i.v_)(l.formatTime(r.lastSyncTime))+")",1)):(0,n.Q3)("",!0)],2),r.activeDeck?((0,n.uX)(),(0,n.CE)("div",ht,[(0,n.Lk)("div",kt,[(0,n.Lk)("div",gt,[(0,n.Lk)("button",{class:"back-btn",onClick:t[3]||(t[3]=(...e)=>l.backToDecks&&l.backToDecks(...e))},t[37]||(t[37]=[(0,n.Lk)("span",{class:"back-icon"},"←",-1),(0,n.eW)(" Back to Decks ")])),(0,n.Lk)("button",{class:"delete-deck-btn",onClick:t[4]||(t[4]=e=>l.promptDeleteDeck(r.activeDeck))}," 🗑️ Delete ")]),(0,n.Lk)("div",Ct,[(0,n.Lk)("div",vt,[(0,n.Lk)("div",ft,[r.isRenaming?((0,n.uX)(),(0,n.CE)("div",bt,[(0,n.bo)((0,n.Lk)("input",{ref:"renameInput","onUpdate:modelValue":t[5]||(t[5]=e=>r.tempDeckName=e),onKeyup:[t[6]||(t[6]=(0,s.jR)(((...e)=>l.confirmRenaming&&l.confirmRenaming(...e)),["enter"])),t[7]||(t[7]=(0,s.jR)(((...e)=>l.cancelRenaming&&l.cancelRenaming(...e)),["esc"]))],onBlur:t[8]||(t[8]=(...e)=>l.cancelRenaming&&l.cancelRenaming(...e)),class:"rename-input"},null,544),[[s.Jo,r.tempDeckName]]),(0,n.Lk)("button",{class:"confirm-rename-btn",onClick:t[9]||(t[9]=(...e)=>l.confirmRenaming&&l.confirmRenaming(...e))},"✓"),(0,n.Lk)("button",{class:"cancel-rename-btn",onClick:t[10]||(t[10]=(...e)=>l.cancelRenaming&&l.cancelRenaming(...e))},"✕")])):((0,n.uX)(),(0,n.CE)("h2",yt,(0,i.v_)(r.activeDeck.name),1)),(0,n.Lk)("div",Lt,[r.isRenaming?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("button",{key:0,class:"rename-btn",onClick:t[11]||(t[11]=(...e)=>l.startRenaming&&l.startRenaming(...e)),title:"Rename Deck"}," ✏️ ")),(0,n.Lk)("button",{class:"export-btn",onClick:t[12]||(t[12]=e=>r.showExportModal=!0),title:"Export Deck"}," 📤 ")])]),(0,n.Lk)("div",xt,[(0,n.Lk)("div",Dt,[(0,n.Lk)("div",{class:"deck-colors",innerHTML:l.formatColors(r.activeDeck.colors)},null,8,wt),(0,n.Lk)("span",{class:(0,i.C4)(["card-count",{"over-limit":l.totalCards>100}])},(0,i.v_)(l.totalCards)+"/100 ",3),(0,n.Lk)("div",Et,[(0,n.Lk)("button",{class:"stats-btn",onClick:t[13]||(t[13]=(...e)=>l.showDeckStats&&l.showDeckStats(...e))},t[38]||(t[38]=[(0,n.Lk)("span",{class:"stats-icon"},"📊",-1),(0,n.eW)(" Stats ")])),r.showStatsPopup?((0,n.uX)(),(0,n.Wv)(c,{key:0,onClose:l.toggleStatsPopup},null,8,["onClose"])):(0,n.Q3)("",!0)])])])])])]),r.activeDeck.commander?((0,n.uX)(),(0,n.CE)("div",St,[t[39]||(t[39]=(0,n.Lk)("h3",{class:"section-title"},"Commander",-1)),(0,n.Lk)("div",{class:"commander-card",onClick:t[14]||(t[14]=e=>l.viewCardDetails(r.activeDeck.commander))},[(0,n.Lk)("img",{src:r.activeDeck.commander.image_uris?.small||r.activeDeck.commander.card_faces?.[0]?.image_uris?.small,alt:r.activeDeck.commander.name},null,8,It),(0,n.Lk)("span",Tt,(0,i.v_)(r.activeDeck.commander.name),1)])])):(0,n.Q3)("",!0),(0,n.Lk)("div",_t,[t[40]||(t[40]=(0,n.Lk)("h3",{class:"section-title"},"Cards",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.sortedCards,(t=>((0,n.uX)(),(0,n.CE)("div",{key:t.id,class:(0,i.C4)(["deck-card",{"invalid-color":!l.isColorIdentityValid(t),"invalid-format":!l.isLegalInCommander(t)}]),style:(0,i.Tr)(l.getCardBorderStyle(t)),"data-invalid-reason":l.isColorIdentityValid(t)?l.isLegalInCommander(t)?"":"Banned/unserious set":"Wrong colors for commander",onClick:a=>e.$emit("view-card",t)},[(0,n.Lk)("div",Ft,[(0,n.Lk)("div",Mt,[(0,n.Lk)("span",Xt,(0,i.v_)(t.name),1),(0,n.Lk)("span",{class:(0,i.C4)(["card-count",{"count-changed":t.count>1}])}," x"+(0,i.v_)(t.count||1),3)])]),(0,n.Lk)("div",Pt,[l.canHaveMultipleCopies(t)?((0,n.uX)(),(0,n.CE)("button",{key:0,class:"add-btn",onClick:(0,s.D$)((e=>l.addOneCard(t,e)),["stop"])}," + ",8,Ot)):(0,n.Q3)("",!0),(0,n.Lk)("button",{class:"remove-btn",onClick:(0,s.D$)((e=>l.removeCard(t)),["stop"])}," − ",8,At)])],14,$t)))),128))]),(0,n.Lk)("div",Qt,[(0,n.Lk)("button",{class:"save-deck-btn",onClick:t[15]||(t[15]=(...e)=>l.saveDeck&&l.saveDeck(...e))}," Save Deck ")])])):((0,n.uX)(),(0,n.CE)("div",ot,[(0,n.Lk)("div",rt,[t[33]||(t[33]=(0,n.Lk)("h2",{class:"sidebar-title"},"Your Decks",-1)),(0,n.Lk)("button",{class:"playtest-btn",onClick:t[0]||(t[0]=e=>l.openPlaytest())}," ▶️ Playtest ")]),(0,n.Lk)("div",it,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.decks,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:"deck-item",onClick:t=>l.loadDeck(e)},[(0,n.Lk)("span",ct,(0,i.v_)(e.name),1),(0,n.Lk)("span",{class:"deck-colors",innerHTML:l.formatColors(e.colors)},null,8,dt),l.getDeckCardCount(e)>100?((0,n.uX)(),(0,n.CE)("span",ut,"!")):(0,n.Q3)("",!0),(0,n.Lk)("button",{class:"delete-deck-btn",onClick:(0,s.D$)((t=>l.promptDeleteDeck(e)),["stop"])}," 🗑️ ",8,mt)],8,lt)))),128))]),t[36]||(t[36]=(0,n.Lk)("div",{class:"gradient-blur"},[(0,n.Lk)("div"),(0,n.Lk)("div"),(0,n.Lk)("div"),(0,n.Lk)("div"),(0,n.Lk)("div"),(0,n.Lk)("div")],-1)),(0,n.Lk)("div",pt,[(0,n.Lk)("button",{class:"create-deck-btn",onClick:t[1]||(t[1]=e=>r.showCreateDeckModal=!0)},t[34]||(t[34]=[(0,n.Lk)("span",{class:"btn-icon"},"+",-1),(0,n.eW)(" Create a Deck ")])),(0,n.Lk)("button",{class:"import-deck-btn",onClick:t[2]||(t[2]=e=>r.showImportModal=!0)},t[35]||(t[35]=[(0,n.Lk)("span",{class:"btn-icon"},"📥",-1),(0,n.eW)(" Import Deck ")]))])])),r.showCreateDeckModal?((0,n.uX)(),(0,n.CE)("div",{key:2,class:"modal-overlay",onClick:t[20]||(t[20]=(0,s.D$)((e=>r.showCreateDeckModal=!1),["self"]))},[(0,n.Lk)("div",Zt,[t[43]||(t[43]=(0,n.Lk)("h2",{class:"modal-title"},"Create New Deck",-1)),(0,n.Lk)("div",Nt,[t[41]||(t[41]=(0,n.Lk)("label",{for:"deckName"},"Deck Name:",-1)),(0,n.bo)((0,n.Lk)("input",{id:"deckName","onUpdate:modelValue":t[16]||(t[16]=e=>r.newDeckName=e),placeholder:"Enter deck name"},null,512),[[s.Jo,r.newDeckName]])]),(0,n.Lk)("div",Rt,[(0,n.Lk)("button",{onClick:t[17]||(t[17]=(...e)=>l.searchCommanderCards&&l.searchCommanderCards(...e))},"Search for Commander")]),r.selectedCommander?((0,n.uX)(),(0,n.CE)("div",Bt,[t[42]||(t[42]=(0,n.Lk)("h3",{class:"modal-subtitle"},"Selected Commander:",-1)),(0,n.Lk)("div",Ht,[(0,n.Lk)("img",{src:r.selectedCommander.image_uris?.small||r.selectedCommander.card_faces?.[0]?.image_uris?.small,alt:r.selectedCommander.name},null,8,Ut),(0,n.Lk)("span",jt,(0,i.v_)(r.selectedCommander.name),1)])])):(0,n.Q3)("",!0),(0,n.Lk)("div",Jt,[(0,n.Lk)("button",{class:"cancel-btn",onClick:t[18]||(t[18]=e=>r.showCreateDeckModal=!1)},"Cancel"),(0,n.Lk)("button",{class:"confirm-btn",disabled:!r.newDeckName||!r.selectedCommander,onClick:t[19]||(t[19]=(...e)=>l.createDeck&&l.createDeck(...e))},"Create",8,zt)])])])):(0,n.Q3)("",!0),r.showCommanderSearch?((0,n.uX)(),(0,n.CE)("div",{key:3,class:"modal-overlay",onClick:t[24]||(t[24]=(0,s.D$)((e=>r.showCommanderSearch=!1),["self"]))},[(0,n.Lk)("div",Kt,[t[44]||(t[44]=(0,n.Lk)("h2",{class:"modal-title"},"Select Commander",-1)),(0,n.Lk)("div",Wt,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[21]||(t[21]=e=>r.commanderQuery=e),onInput:t[22]||(t[22]=(...e)=>l.searchCommanderCards&&l.searchCommanderCards(...e)),placeholder:"Search for legendary creatures..."},null,544),[[s.Jo,r.commanderQuery]])]),(0,n.Lk)("div",qt,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.commanderResults,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:"commander-option",onClick:t=>l.selectCommander(e)},[(0,n.Lk)("img",{src:e.image_uris?.small||e.card_faces?.[0]?.image_uris?.small,alt:e.name},null,8,Gt),(0,n.Lk)("span",Yt,(0,i.v_)(e.name),1)],8,Vt)))),128))]),(0,n.Lk)("div",ea,[(0,n.Lk)("button",{class:"cancel-btn",onClick:t[23]||(t[23]=e=>r.showCommanderSearch=!1)},"Cancel")])])])):(0,n.Q3)("",!0),r.showDeleteConfirmation?((0,n.uX)(),(0,n.CE)("div",{key:4,class:"modal-overlay",onClick:t[27]||(t[27]=(0,s.D$)((e=>r.showDeleteConfirmation=!1),["self"]))},[(0,n.Lk)("div",ta,[t[45]||(t[45]=(0,n.Lk)("h2",{class:"modal-title"},"Delete Deck",-1)),(0,n.Lk)("p",null,'Are you sure you want to delete "'+(0,i.v_)(r.deckToDelete?.name)+'"? This action cannot be undone.',1),(0,n.Lk)("div",aa,[(0,n.Lk)("button",{class:"cancel-btn",onClick:t[25]||(t[25]=e=>r.showDeleteConfirmation=!1)},"Cancel"),(0,n.Lk)("button",{class:"confirm-btn delete-btn",onClick:t[26]||(t[26]=(...e)=>l.confirmDeleteDeck&&l.confirmDeleteDeck(...e))},"Delete")])])])):(0,n.Q3)("",!0),r.showImportModal?((0,n.uX)(),(0,n.Wv)(d,{key:5,isOpen:r.showImportModal,onClose:t[28]||(t[28]=e=>r.showImportModal=!1),onImport:l.handleDeckImport},null,8,["isOpen","onImport"])):(0,n.Q3)("",!0),r.showExportModal?((0,n.uX)(),(0,n.Wv)(u,{key:6,isOpen:r.showExportModal,deck:r.activeDeck,onClose:t[29]||(t[29]=e=>r.showExportModal=!1)},null,8,["isOpen","deck"])):(0,n.Q3)("",!0),r.showStatsModal?((0,n.uX)(),(0,n.Wv)(c,{key:7,isOpen:r.showStatsModal,deck:r.activeDeck,onClose:t[30]||(t[30]=e=>r.showStatsModal=!1),onViewCard:l.viewCardDetails},null,8,["isOpen","deck","onViewCard"])):(0,n.Q3)("",!0),r.showPlaytestPopup?((0,n.uX)(),(0,n.Wv)(m,{key:8,ref:"playtestPopup",decks:r.decks,onClose:t[31]||(t[31]=e=>r.showPlaytestPopup=!1)},null,8,["decks"])):(0,n.Q3)("",!0)])}a(3215),a(8872);var na=a(7617),oa=a(6400);const ra={apiKey:"AIzaSyCZ_oyITjmkiM0f0dpqyyiOeSrDAvQSrQs",authDomain:"mtg-deckbuilder-unideb.firebaseapp.com",projectId:"mtg-deckbuilder-unideb",storageBucket:"mtg-deckbuilder-unideb.appspot.app",messagingSenderId:"10676099449",appId:"1:10676099449:web:60d6b82095b2d6d6ceb7a8"},ia=(0,oa.Wp)(ra),la=(0,na.aU)(ia);async function ca(e){await(0,na.BN)((0,na.H9)(la,"decks",e.id),e)}async function da(){const e=await(0,na.GG)((0,na.rJ)(la,"decks"));return e.docs.map((e=>e.data()))}async function ua(e){await(0,na.kd)((0,na.H9)(la,"decks",e))}const ma={class:"form-group"},pa={class:"form-group"},ha=["disabled"],ka={key:0,class:"error-message"},ga={key:1,class:"processing-message"},Ca={key:2,class:"commander-selection-modal"},va={class:"commander-options-container"},fa={class:"commander-options"},ya=["onClick","onMouseenter"],ba={key:0,class:"card-preview"},La=["src"],xa=["src"],Da={key:2,class:"no-image"},wa={class:"modal-actions"},Ea=["disabled"];function Sa(e,t,a,o,r,l){return a.isOpen?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"modal-overlay",onClick:t[6]||(t[6]=t=>e.$emit("close"))},[(0,n.Lk)("div",{class:"modal-content",onClick:t[5]||(t[5]=(0,s.D$)((()=>{}),["stop"]))},[t[11]||(t[11]=(0,n.Lk)("h2",{class:"modal-title"},"Import Deck",-1)),(0,n.Lk)("div",ma,[t[7]||(t[7]=(0,n.Lk)("label",{for:"deckName"},"Deck Name:",-1)),(0,n.bo)((0,n.Lk)("input",{id:"deckName","onUpdate:modelValue":t[0]||(t[0]=e=>o.deckName=e),type:"text",placeholder:"Enter deck name"},null,512),[[s.Jo,o.deckName]])]),(0,n.Lk)("div",pa,[t[8]||(t[8]=(0,n.Lk)("label",{for:"deckFile"},"Deck List (txt file):",-1)),(0,n.Lk)("input",{ref:"fileInputRef",id:"deckFile",type:"file",accept:".txt",onChange:t[1]||(t[1]=(...e)=>o.handleFileUpload&&o.handleFileUpload(...e)),disabled:o.processing||!o.deckName.trim()},null,40,ha)]),t[12]||(t[12]=(0,n.Lk)("div",{class:"import-instructions"},[(0,n.Lk)("h3",null,"Format Instructions:"),(0,n.Lk)("pre",{class:"format-example"},"Commander\n1x Example Commander Card (set)\n1x Example Card (set)\n13x Example Land (set)"),(0,n.Lk)("ul",null,[(0,n.Lk)("li",null,'First line should be "Commander" (optional)'),(0,n.Lk)("li",null,"Card format: [quantity]x Card Name (Set Code)"),(0,n.Lk)("li",null,"Quantity and set code are optional"),(0,n.Lk)("li",null,"If no commander line, you'll be prompted to choose one")])],-1)),o.error?((0,n.uX)(),(0,n.CE)("div",ka,(0,i.v_)(o.error),1)):(0,n.Q3)("",!0),o.processing?((0,n.uX)(),(0,n.CE)("div",ga,"Processing deck list...")):(0,n.Q3)("",!0),o.showCommanderSelection?((0,n.uX)(),(0,n.CE)("div",Ca,[t[9]||(t[9]=(0,n.Lk)("h3",null,"No commander specified",-1)),t[10]||(t[10]=(0,n.Lk)("p",null,"Please select a commander from these valid options:",-1)),(0,n.Lk)("div",va,[(0,n.Lk)("div",fa,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.potentialCommanders,((e,a)=>((0,n.uX)(),(0,n.CE)("div",{key:a,class:(0,i.C4)(["commander-option",{selected:o.selectedCommanderIndex===a}]),onClick:e=>o.selectedCommanderIndex=a,onMouseenter:e=>o.hoveredCommanderIndex=a,onMouseleave:t[2]||(t[2]=e=>o.hoveredCommanderIndex=null)},(0,i.v_)(e.name),43,ya)))),128))]),null!==o.hoveredCommanderIndex?((0,n.uX)(),(0,n.CE)("div",ba,[o.potentialCommanders[o.hoveredCommanderIndex].image_uris?.normal?((0,n.uX)(),(0,n.CE)("img",{key:0,src:o.potentialCommanders[o.hoveredCommanderIndex].image_uris.normal,alt:"Card preview"},null,8,La)):o.potentialCommanders[o.hoveredCommanderIndex].card_faces&&o.potentialCommanders[o.hoveredCommanderIndex].card_faces[0]?.image_uris?.normal?((0,n.uX)(),(0,n.CE)("img",{key:1,src:o.potentialCommanders[o.hoveredCommanderIndex].card_faces[0].image_uris.normal,alt:"Card front face"},null,8,xa)):((0,n.uX)(),(0,n.CE)("div",Da," No image available "))])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",wa,[(0,n.Lk)("button",{class:"cancel-btn",onClick:t[3]||(t[3]=(...e)=>o.cancelCommanderSelection&&o.cancelCommanderSelection(...e))},"Cancel"),(0,n.Lk)("button",{class:"confirm-btn",onClick:t[4]||(t[4]=(...e)=>o.confirmCommanderSelection&&o.confirmCommanderSelection(...e)),disabled:null===o.selectedCommanderIndex}," Confirm ",8,Ea)])])):(0,n.Q3)("",!0)])])):(0,n.Q3)("",!0)}a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698),a(3949),a(7550);var Ia=a(144),Ta={name:"ImportPopup",props:{isOpen:{type:Boolean,required:!0}},emits:["close","import"],setup(e,{emit:t}){const a=(0,Ia.KR)(""),s=(0,Ia.KR)(null),n=(0,Ia.KR)(!1),o=(0,Ia.KR)([]),r=(0,Ia.KR)(null),i=(0,Ia.KR)(!1),l=(0,Ia.KR)([]),c=(0,Ia.KR)(null),d=(0,Ia.KR)(null),u=e=>{const t=e.trim();if(!t||"commander"===t.toLowerCase())return null;const a=/^(?:(?<quantity>\d+)\s*(?:x\s*)?)?(?<name>.+?)(?:\s*\((?<set>[^)]+)\))?\s*$/,s=t.match(a);return s&&s.groups.name.trim()?{name:s.groups.name.trim(),count:s.groups.quantity?parseInt(s.groups.quantity):1,setCode:s.groups.set?s.groups.set.trim():void 0}:null},m=e=>{if(!e.type_line)return!1;const t=e.type_line.toLowerCase(),a=t.includes("legendary"),s=t.includes("creature")||t.includes("god"),n=t.includes("planeswalker"),o=t.includes("can be your commander");return a&&(s||n)||o},p=async e=>{const t=[];for(const a of e)try{const e=await L.A.get("https://api.scryfall.com/cards/search",{params:{q:`!"${a.name.replace(/"/g,"")}"`,unique:"cards"}});if(e.data.data.length>0){const s=e.data.data[0];m(s)&&t.push({...s,count:a.count,originalName:a.name})}}catch(s){console.error(`Error fetching card: ${a.name}`,s)}return t},h=(e,t)=>{const a=e.split("\n").filter((e=>{const t=e.trim();return t&&"commander"!==t.toLowerCase()})),s=[],n=[];return a.forEach((e=>{const a=u(e);if(a){const o=a.name.toLowerCase();n.push(o),t.some((e=>e.name.toLowerCase()===o))||s.push(e.trim())}})),{missingCards:s}},k=async e=>{const t=e.split("\n").filter((e=>e.trim()));let a=null;const n=[],o=[],r="commander"===t[0]?.trim().toLowerCase();if(r&&t.length>1){const e=t[1],n=u(e);if(n)try{const e=await L.A.get("https://api.scryfall.com/cards/search",{params:{q:`!"${n.name.replace(/"/g,"")}"`,unique:"cards"}});if(!(e.data.data.length>0))throw new Error(`Commander not found: ${n.name}`);a=e.data.data[0],a.count=1,a.isCommander=!0}catch(s){console.error(`Commander not found: ${n.name}`,s)}t.splice(0,2)}for(const s of t){const e=u(s);e&&n.push(e)}const i=[],l=new Set;for(const c of n)try{if(a&&c.name.toLowerCase()===a.name.toLowerCase())continue;await new Promise((e=>setTimeout(e,100)));const e=await L.A.get("https://api.scryfall.com/cards/search",{params:{q:`!"${c.name.replace(/"/g,"")}"`,unique:"cards"}});if(e.data.data.length>0){const t=e.data.data[0];t.count=c.count,l.has(t.name)||(i.push(t),l.add(t.name))}else{const e=await L.A.get("https://api.scryfall.com/cards/search",{params:{q:c.name,unique:"cards"}});if(!(e.data.data.length>0))throw new Error(`Card not found: ${c.name}`);{const t=e.data.data[0];t.count=c.count,l.has(t.name)||(i.push(t),l.add(t.name))}}}catch(s){l.has(c.name)||o.push(`${c.name}`)}return{commander:a,cards:i,skipped:o}},g=async e=>{const t=e.target.files[0];if(t)if(a.value.trim()){n.value=!0,s.value=null,o.value=[];try{const e=await t.text(),a=await k(e);if(!a.commander){const e=await p(a.cards);if(e.length>0)return l.value=e,d.value=a,i.value=!0,void(n.value=!1);throw new Error("No valid commanders found in the deck list")}C(a,e)}catch(c){s.value=c instanceof Error?c.message:"Failed to process deck list",console.error("Import error:",c)}finally{i.value||(n.value=!1,r.value&&(r.value.value=""))}}else s.value="Please enter a deck name first"},C=(e,s)=>{const{missingCards:n}=h(s,e.cards);if(n.length>0){let e=`Missing cards (${n.length}):\n${n.slice(0,5).join("\n")}`;n.length>5&&(e+=`\n...and ${n.length-5} more`),alert(`Import verification issues:\n${e}`)}e.skipped.length>0&&alert(`Note: The following cards were not found and were skipped:\n${e.skipped.slice(0,10).join("\n")}${e.skipped.length>10?`\n...and ${e.skipped.length-10} more`:""}`),t("import",{name:a.value,commander:e.commander,cards:e.cards,colors:e.commander?.color_identity||[],created:(new Date).toISOString(),missingCards:n}),t("close")},v=(0,Ia.KR)(null),f=()=>{if(null!==c.value&&d.value){const e=l.value[c.value];e.isCommander=!0,e.count=1;const t=d.value.cards.filter((t=>t.name.toLowerCase()!==e.name.toLowerCase()));C({commander:e,cards:[e,...t],skipped:d.value.skipped},"")}b()},y=()=>{b(),r.value&&(r.value.value="")},b=()=>{i.value=!1,l.value=[],c.value=null,d.value=null,n.value=!1};return{deckName:a,error:s,processing:n,skippedCards:o,fileInputRef:r,handleFileUpload:g,showCommanderSelection:i,hoveredCommanderIndex:v,potentialCommanders:l,selectedCommanderIndex:c,confirmCommanderSelection:f,cancelCommanderSelection:y}}};const _a=(0,$.A)(Ta,[["render",Sa],["__scopeId","data-v-34627c5c"]]);var $a=_a;const Fa={class:"modal-content export-modal"},Ma={class:"deck-info"},Xa={class:"deck-meta"},Pa=["innerHTML"],Oa={class:"card-count"},Aa={class:"export-format"},Qa={class:"format-preview"},Za={class:"modal-actions"},Na=["disabled"];function Ra(e,t,a,o,r,l){return a.isOpen?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"modal-overlay",onClick:t[2]||(t[2]=(0,s.D$)(((...e)=>l.close&&l.close(...e)),["self"]))},[(0,n.Lk)("div",Fa,[t[4]||(t[4]=(0,n.Lk)("h2",{class:"modal-title"},"Export Deck",-1)),(0,n.Lk)("div",Ma,[(0,n.Lk)("h3",null,(0,i.v_)(a.deck?.name||"Untitled Deck"),1),(0,n.Lk)("div",Xa,[(0,n.Lk)("div",{class:"deck-colors",innerHTML:l.formatColors(a.deck?.colors||[])},null,8,Pa),(0,n.Lk)("span",Oa,(0,i.v_)(l.totalCards)+"/100 cards",1)])]),(0,n.Lk)("div",Aa,[t[3]||(t[3]=(0,n.Lk)("h4",null,"Export Format:",-1)),(0,n.Lk)("div",Qa,[(0,n.Lk)("pre",null,(0,i.v_)(l.formattedDecklist),1)])]),(0,n.Lk)("div",Za,[(0,n.Lk)("button",{class:"cancel-btn",onClick:t[0]||(t[0]=(...e)=>l.close&&l.close(...e))},"Cancel"),(0,n.Lk)("button",{class:"export-btn",onClick:t[1]||(t[1]=(...e)=>l.exportDecklist&&l.exportDecklist(...e)),disabled:!a.deck?.cards?.length}," Export Decklist ",8,Na)])])])):(0,n.Q3)("",!0)}a(4603),a(7566),a(8721);var Ba={name:"ExportPopup",props:{isOpen:Boolean,deck:{type:Object,default:()=>({name:"",colors:[],cards:[],commander:null})}},computed:{totalCards(){return this.deck?.cards?this.deck.cards.reduce(((e,t)=>e+(t.count||1)),0):0},formattedDecklist(){if(!this.deck?.cards)return"";const e={};this.deck.cards.forEach((t=>{const a=`${t.name} (${t.set?.toUpperCase()||"Unknown"})`;e[a]=(e[a]||0)+(t.count||1)}));const t=Object.keys(e).sort(((e,t)=>e.localeCompare(t))).map((t=>`${e[t]}x ${t}`));let a=[];return this.deck.commander&&(a.push(`Commander: 1x ${this.deck.commander.name} (${this.deck.commander.set?.toUpperCase()||"Unknown"})`),a.push("")),a=a.concat(t),a.join("\n")}},methods:{close(){this.$emit("close")},formatColors(e){return e&&0!==e.length?e.map((e=>`<span class="mana small s${e.toLowerCase()}"></span>`)).join(" "):""},exportDecklist(){const e=new Blob([this.formattedDecklist],{type:"text/plain"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download=`${this.deck.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_decklist.txt`,document.body.appendChild(a),a.click(),setTimeout((()=>{document.body.removeChild(a),URL.revokeObjectURL(t)}),100),this.close()}}};const Ha=(0,$.A)(Ba,[["render",Ra],["__scopeId","data-v-76e13334"]]);var Ua=Ha;const ja={class:"stats-modal-content"},Ja={class:"stats-section"},za={class:"basic-info-grid"},Ka={class:"info-item"},Wa={class:"info-value"},qa={key:0,class:"info-item commander-item"},Va=["src","alt"],Ga={class:"stats-section"},Ya={class:"chart-container",style:{height:"150px"}},es={class:"curve-metrics"},ts={class:"metric"},as={class:"metric-value"},ss={class:"metric"},ns={class:"metric-value"},os={class:"stats-section"},rs={class:"chart-container"},is={class:"stats-section"},ls={class:"mana-base-grid"},cs={class:"land-count"},ds={class:"metric-value"},us={class:"land-breakdown"},ms={class:"basic-lands"},ps={class:"land-count-value"},hs={class:"nonbasic-lands"},ks={class:"land-count-value"},gs={class:"color-pips"},Cs={class:"color-count"},vs={class:"color-name"},fs={class:"stats-section"},ys={class:"chart-container"},bs={class:"stats-section"},Ls={class:"cost-grid"},xs={class:"cost-metric"},Ds={class:"metric-value"},ws={class:"cost-metric"},Es={class:"metric-value"},Ss={class:"most-expensive"},Is={class:"card-price"},Ts={class:"chart-container"},_s={class:"stats-section"},$s={class:"thematic-grid"},Fs={class:"chart-container"},Ms={class:"chart-container"};function Xs(e,t,a,o,r,l){const c=(0,n.g2)("bar-chart"),d=(0,n.g2)("pie-chart");return a.isOpen?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"stats-modal-overlay",onClick:t[3]||(t[3]=(0,s.D$)(((...e)=>l.close&&l.close(...e)),["self"]))},[(0,n.Lk)("div",ja,[(0,n.Lk)("button",{class:"close-btn",onClick:t[0]||(t[0]=(...e)=>l.close&&l.close(...e))},"×"),t[21]||(t[21]=(0,n.Lk)("h2",{class:"stats-modal-title"},"Deck Statistics",-1)),(0,n.Lk)("section",Ja,[t[6]||(t[6]=(0,n.Lk)("h3",{class:"section-title"},"🔹 Basic Info",-1)),(0,n.Lk)("div",za,[(0,n.Lk)("div",Ka,[t[4]||(t[4]=(0,n.Lk)("span",{class:"info-label"},"Deck Name:",-1)),(0,n.Lk)("span",Wa,(0,i.v_)(a.deck?.name||"Untitled Deck"),1)]),a.deck?.commander?((0,n.uX)(),(0,n.CE)("div",qa,[t[5]||(t[5]=(0,n.Lk)("span",{class:"info-label"},"Commander:",-1)),(0,n.Lk)("div",{class:"commander-preview",onClick:t[1]||(t[1]=e=>l.viewCard(a.deck.commander))},[(0,n.Lk)("img",{src:l.commanderImage,alt:a.deck.commander.name},null,8,Va),(0,n.Lk)("span",null,(0,i.v_)(a.deck.commander.name),1)])])):(0,n.Q3)("",!0)])]),(0,n.Lk)("section",Ga,[t[9]||(t[9]=(0,n.Lk)("h3",{class:"section-title"},"🔸 Mana Curve & Speed",-1)),(0,n.Lk)("div",Ya,[(0,n.bF)(c,{data:l.manaCurveChartData,options:r.manaCurveOptions},null,8,["data","options"])]),(0,n.Lk)("div",es,[(0,n.Lk)("div",ts,[(0,n.Lk)("div",as,(0,i.v_)(l.avgManaValue.toFixed(1)),1),t[7]||(t[7]=(0,n.Lk)("div",{class:"metric-label"},"Avg Mana Value",-1))]),(0,n.Lk)("div",ss,[(0,n.Lk)("div",ns,(0,i.v_)(l.lowCostCards),1),t[8]||(t[8]=(0,n.Lk)("div",{class:"metric-label"},"Cards ≤ 2 MV",-1))])])]),(0,n.Lk)("section",os,[t[10]||(t[10]=(0,n.Lk)("h3",{class:"section-title"},"🟢 Card Type Composition",-1)),(0,n.Lk)("div",rs,[(0,n.bF)(d,{data:l.cardTypeChartData,options:r.pieChartOptions,height:250},null,8,["data","options"])])]),(0,n.Lk)("section",is,[t[14]||(t[14]=(0,n.Lk)("h3",{class:"section-title"},"🔵 Mana Base",-1)),(0,n.Lk)("div",ls,[(0,n.Lk)("div",cs,[(0,n.Lk)("div",ds,(0,i.v_)(l.landCount),1),t[13]||(t[13]=(0,n.Lk)("div",{class:"metric-label"},"Total Lands",-1)),(0,n.Lk)("div",us,[(0,n.Lk)("div",ms,[t[11]||(t[11]=(0,n.Lk)("span",{class:"land-type"},"Basic:",-1)),(0,n.Lk)("span",ps,(0,i.v_)(l.basicLandCount),1)]),(0,n.Lk)("div",hs,[t[12]||(t[12]=(0,n.Lk)("span",{class:"land-type"},"Nonbasic:",-1)),(0,n.Lk)("span",ks,(0,i.v_)(l.nonbasicLandCount),1)])])]),(0,n.Lk)("div",gs,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.landColors,(e=>((0,n.uX)(),(0,n.CE)("div",{class:"color-pip",key:e.identity},[(0,n.Lk)("span",{class:(0,i.C4)(["mana",`s${e.identity.toLowerCase()}`])},null,2),(0,n.Lk)("span",Cs,(0,i.v_)(e.count),1),(0,n.Lk)("span",vs,(0,i.v_)(l.getColorName(e.identity)),1)])))),128))])])]),(0,n.Lk)("section",fs,[t[15]||(t[15]=(0,n.Lk)("h3",{class:"section-title"},"🟣 Color Identity",-1)),(0,n.Lk)("div",ys,[(0,n.bF)(d,{data:l.colorIdentityChartData,options:r.pieChartOptions,height:250},null,8,["data","options"])])]),(0,n.Lk)("section",bs,[t[19]||(t[19]=(0,n.Lk)("h3",{class:"section-title"},"🟠 Cost & Value",-1)),(0,n.Lk)("div",Ls,[(0,n.Lk)("div",xs,[(0,n.Lk)("div",Ds,"$"+(0,i.v_)(l.totalDeckPrice.toFixed(2)),1),t[16]||(t[16]=(0,n.Lk)("div",{class:"metric-label"},"Total Deck Price",-1))]),(0,n.Lk)("div",ws,[(0,n.Lk)("div",Es,"$"+(0,i.v_)(l.avgCardPrice.toFixed(2)),1),t[17]||(t[17]=(0,n.Lk)("div",{class:"metric-label"},"Avg Card Price",-1))]),(0,n.Lk)("div",Ss,[t[18]||(t[18]=(0,n.Lk)("div",{class:"metric-label"},"Most Expensive:",-1)),(0,n.Lk)("div",{class:"expensive-card",onClick:t[2]||(t[2]=e=>l.viewCard(l.mostExpensiveCard))},[(0,n.eW)((0,i.v_)(l.mostExpensiveCard.name)+" ",1),(0,n.Lk)("span",Is,"($"+(0,i.v_)(l.mostExpensiveCardPrice.toFixed(2))+")",1)])]),(0,n.Lk)("div",Ts,[(0,n.bF)(c,{data:l.budgetChartData,options:r.budgetChartOptions,height:100},null,8,["data","options"])])])]),(0,n.Lk)("section",_s,[t[20]||(t[20]=(0,n.Lk)("h3",{class:"section-title"},"🟤 Thematic Content",-1)),(0,n.Lk)("div",$s,[(0,n.Lk)("div",Fs,[(0,n.bF)(d,{data:l.creatureTypeChartData,options:r.pieChartOptions,height:250},null,8,["data","options"])]),(0,n.Lk)("div",Ms,[(0,n.bF)(c,{data:l.keywordChartData,options:r.keywordChartOptions,height:250},null,8,["data","options"])])])])])])):(0,n.Q3)("",!0)}var Ps=a(6912),Os=a(1010);Ps.t1.register(Ps.hE,Ps.m_,Ps.s$,Ps.E8,Ps.PP,Ps.kc,Ps.Bs);var As={name:"StatsPopup",components:{BarChart:Os.yP,PieChart:Os.Fq},props:{isOpen:Boolean,deck:{type:Object,default:null}},data(){return{typeColors:{Creature:"#6EE7B7",Instant:"#93C5FD",Sorcery:"#818CF8",Artifact:"#A5B4FC",Enchantment:"#C4B5FD",Planeswalker:"#F9A8D4",Land:"#FCD34D",Other:"#D1D5DB"},colorPalette:["#4E79A7","#F28E2B","#E15759","#76B7B2","#59A14F","#EDC948","#B07AA1","#FF9DA7","#9C755F","#BAB0AC"],pieChartOptions:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right"},tooltip:{callbacks:{label:e=>{const t=e.label||"",a=e.raw||0,s=e.dataset.data.reduce(((e,t)=>e+t),0),n=Math.round(a/s*100);return`${t}: ${a} (${n}%)`}}}}},manaCurveOptions:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{stepSize:1,precision:0},grid:{display:!1}},x:{grid:{display:!1}}},plugins:{legend:{display:!1}},barPercentage:.6,categoryPercentage:.7},keywordChartOptions:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},indexAxis:"y",scales:{x:{beginAtZero:!0,ticks:{precision:0,stepSize:1}}}},budgetChartOptions:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{display:!1}}}}},computed:{commanderImage(){return this.deck?.commander&&(this.deck.commander.image_uris?.small||this.deck.commander.card_faces?.[0]?.image_uris?.small)||""},totalCards(){return this.deck?.cards?this.deck.cards.reduce(((e,t)=>e+(t.count||1)),0):0},avgManaValue(){if(!this.deck?.cards)return 0;let e=0,t=0;return this.deck.cards.forEach((a=>{if((a.type_line||"").includes("Land"))return;const s=a.count||1;e+=(a.cmc||0)*s,t+=s})),t>0?e/t:0},lowCostCards(){if(!this.deck?.cards)return 0;const e=this.manaCurveChartData.datasets[0].data,t=this.manaCurveChartData.labels,a=t.indexOf("0"),s=t.indexOf("1"),n=t.indexOf("2");return(a>=0?e[a]:0)+(s>=0?e[s]:0)+(n>=0?e[n]:0)},manaCurveChartData(){const e={0:0,1:0,2:0,3:0,4:0,5:0,6:0,"7+":0};return this.deck?.cards&&this.deck.cards.forEach((t=>{const a=t.cmc||0,s=t.count||1;(t.type_line||"").includes("Land")||(a<=6?e[a.toString()]+=s:e["7+"]+=s)})),{labels:Object.keys(e),datasets:[{label:"Cards",backgroundColor:"#4299e1",data:Object.values(e)}]}},cardTypeChartData(){const e={Creature:0,Instant:0,Sorcery:0,Artifact:0,Enchantment:0,Planeswalker:0,Land:0,Other:0};this.deck?.cards&&this.deck.cards.forEach((t=>{const a=t.count||1,s=t.type_line||"";s.includes("Creature")?e["Creature"]+=a:s.includes("Instant")?e["Instant"]+=a:s.includes("Sorcery")?e["Sorcery"]+=a:s.includes("Artifact")?e["Artifact"]+=a:s.includes("Enchantment")?e["Enchantment"]+=a:s.includes("Planeswalker")?e["Planeswalker"]+=a:s.includes("Land")?e["Land"]+=a:e["Other"]+=a}));const t=Object.entries(e).filter((([,e])=>e>0)).map((([e,t])=>({name:e,count:t})));return{labels:t.map((e=>e.name)),datasets:[{backgroundColor:t.map((e=>this.typeColors[e.name]||"#D1D5DB")),data:t.map((e=>e.count))}]}},landCount(){return this.deck?.cards?this.deck.cards.reduce(((e,t)=>{const a=(t.type_line||"").includes("Land");return e+(a?t.count||1:0)}),0):0},basicLandCount(){return this.deck?.cards?this.deck.cards.reduce(((e,t)=>{const a=(t.type_line||"").includes("Basic Land");return e+(a?t.count||1:0)}),0):0},nonbasicLandCount(){return this.landCount-this.basicLandCount},landColors(){if(!this.deck?.cards||!this.deck?.colors)return[];const e={};return this.deck.colors.forEach((t=>{e[t]={identity:t,count:0}})),this.deck.cards.forEach((t=>{if((t.type_line||"").includes("Land")){const a=t.count||1,s=this.getLandColors(t);s.forEach((t=>{e[t]&&(e[t].count+=a)}))}})),Object.values(e).sort(((e,t)=>t.count-e.count))},colorIdentityChartData(){if(!this.deck?.colors)return{labels:[],datasets:[]};const e={};this.deck.colors.forEach((t=>{e[t]=0})),this.deck.cards&&this.deck.cards.forEach((t=>{const a=t.count||1,s=t.color_identity||[];s.forEach((t=>{void 0!==e[t]&&(e[t]+=a)}))}));const t=Object.entries(e).filter((([,e])=>e>0)).map((([e,t])=>({color:e,count:t,name:this.getColorName(e)})));return{labels:t.map((e=>e.name)),datasets:[{backgroundColor:t.map((e=>this.getColorHex(e.color))),data:t.map((e=>e.count))}]}},creatureTypeChartData(){const e={};this.deck?.cards&&this.deck.cards.forEach((t=>{if((t.type_line||"").includes("Creature")){const a=(t.type_line||"").split("—"),s=a.length>1?a[1]:"",n=s.trim().split(/[\s/]+/).filter((e=>e&&"//"!==e&&!e.match(/^[^a-zA-Z]/))),o=t.count||1;n.forEach((t=>{e[t]=(e[t]||0)+o}))}}));const t=Object.entries(e).map((([e,t])=>({name:e,count:t}))).sort(((e,t)=>t.count-e.count)).slice(0,8);return{labels:t.map((e=>e.name)),datasets:[{backgroundColor:t.map(((e,t)=>this.getColorForIndex(t))),data:t.map((e=>e.count))}]}},keywordChartData(){const e={},t=["Flying","Trample","Haste","Vigilance","Deathtouch","Lifelink","Menace","Hexproof","Indestructible","First strike","Double strike","Flash","Reach","Defender","Ward"];this.deck?.cards&&this.deck.cards.forEach((a=>{const s=(a.oracle_text||"").toLowerCase(),n=a.count||1,o=(a.type_line||"").toLowerCase(),r=o.includes("creature"),i=o.includes("instant"),l=o.includes("sorcery");t.forEach((t=>{const a=t.toLowerCase();if(s.includes(a)){if("flying"===a&&!r&&!s.includes("enchant creature")||["trample","haste","vigilance","deathtouch","lifelink","menace","first strike","double strike","reach"].includes(a)&&!r||"flash"===a&&!i&&!l&&!r)return;e[t]=(e[t]||0)+n}}))}));const a=Object.entries(e).map((([e,t])=>({name:e,count:t}))).sort(((e,t)=>t.count-e.count)).slice(0,8);return{labels:a.map((e=>e.name)),datasets:[{backgroundColor:"#9F7AEA",data:a.map((e=>e.count))}]}},totalDeckPrice(){return this.deck?.cards?this.deck.cards.reduce(((e,t)=>{const a=parseFloat(t.prices?.usd||"0")||0;return e+a*(t.count||1)}),0):0},avgCardPrice(){return 0===this.totalCards?0:this.totalDeckPrice/this.totalCards},mostExpensiveCard(){if(!this.deck?.cards)return{name:"N/A"};let e=0,t=null;return this.deck.cards.forEach((a=>{const s=parseFloat(a.prices?.usd||"0")||0;s>e&&(e=s,t=a)})),t||{name:"N/A"}},mostExpensiveCardPrice(){return parseFloat(this.mostExpensiveCard.prices?.usd||"0")||0},budgetChartData(){if(!this.deck?.cards)return{labels:[],datasets:[]};let e=0,t=0,a=0;return this.deck.cards.forEach((s=>{const n=parseFloat(s.prices?.usd||"0")||0,o=s.count||1;n<1?e+=o:n<=5?t+=o:a+=o})),{labels:["Under $1","$1-$5","Over $5"],datasets:[{backgroundColor:["#48BB78","#4299E1","#9F7AEA"],data:[e,t,a]}]}}},methods:{close(){this.$emit("close")},viewCard(e){this.$emit("view-card",e)},getLandColors(e){return e.color_identity||[]},getColorName(e){const t={W:"White",U:"Blue",B:"Black",R:"Red",G:"Green"};return t[e]||e},getColorHex(e){const t={W:"#F8F8F7",U:"#0E68AB",B:"#150B00",R:"#D3202A",G:"#00733E"};return t[e]||"#CCCCCC"},getColorForIndex(e){return this.colorPalette[e%this.colorPalette.length]}}};const Qs=(0,$.A)(As,[["render",Xs],["__scopeId","data-v-0e59be87"]]);var Zs=Qs;const Ns={class:"playtest-popup"},Rs={key:0,class:"playtest-content"},Bs={class:"popup-header"},Hs={key:0,class:"deck-selection"},Us={key:0,class:"no-decks-message"},js={key:0},Js={key:1},zs=["onClick"],Ks={key:1,class:"initial-draw"},Ws={class:"initial-draw-hand-container"},qs=["onClick"],Vs=["src","alt"],Gs={class:"action-buttons"},Ys={key:2,class:"playtest-interface"},en={class:"top-row"},tn={class:"zone-header"},an={key:0,class:"commander-tax-display"},sn={key:0,class:"zone-preview"},nn={key:0},on=["src","alt","onDragstart","onContextmenu"],rn={key:1,class:"empty-zone-message"},ln={key:1,class:"expanded-zone command-expanded"},cn={class:"expanded-cards"},dn=["src","alt","onDragstart","onContextmenu"],un={key:0,class:"empty-zone-message"},mn={key:0,class:"zone-preview"},pn=["src","alt","onDragstart","onContextmenu"],hn={key:0,class:"more-cards-indicator"},kn={key:1,class:"empty-zone-message"},gn={key:1,class:"expanded-zone graveyard-expanded"},Cn={class:"expanded-cards"},vn=["src","alt","onDragstart","onContextmenu"],fn={key:0,class:"empty-zone-message"},yn={key:0,class:"zone-preview"},bn=["src","alt","onDragstart","onContextmenu"],Ln={key:0,class:"more-cards-indicator"},xn={key:1,class:"empty-zone-message"},Dn={key:1,class:"expanded-zone exile-expanded"},wn={class:"expanded-cards"},En=["src","alt","onDragstart","onContextmenu"],Sn={key:0,class:"empty-zone-message"},In={class:"battlefield-cards"},Tn=["onMousedown"],_n=["src","alt","onDragstart","onContextmenu"],$n={key:0,class:"counter-badge"},Fn={key:1,class:"pt-indicator"},Mn={class:"bottom-row"},Xn=["src"],Pn={class:"hand-cards"},On=["src","alt","onDragstart","onContextmenu"],An={key:0,class:"quantity-badge"},Qn={key:0,class:"empty-zone-message"},Zn={class:"token-form"},Nn={class:"modal-buttons token-modal-buttons"},Rn={class:"pt-form"},Bn={class:"modal-buttons pt-modal-buttons"},Hn={class:"search-results"},Un=["onClick"],jn=["src","alt"],Jn={key:0,class:"empty-zone-message"},zn={key:1,class:"empty-zone-message"},Kn={key:2,class:"empty-zone-message"},Wn={class:"modal-buttons library-search-buttons"},qn={key:1,class:"loading"};function Vn(e,t,a,o,r,l){return(0,n.uX)(),(0,n.CE)("div",Ns,[r.isInitialized?((0,n.uX)(),(0,n.CE)("div",Rs,[(0,n.Lk)("div",Bs,[t[61]||(t[61]=(0,n.Lk)("h2",null,"Playtest",-1)),(0,n.Lk)("button",{class:"close-btn",onClick:t[0]||(t[0]=(...e)=>l.closePopup&&l.closePopup(...e))},"×")]),"select"===r.phase?((0,n.uX)(),(0,n.CE)("div",Hs,[t[63]||(t[63]=(0,n.Lk)("h3",null,"Select a deck to playtest",-1)),a.decks&&0!==a.decks.length?((0,n.uX)(),(0,n.CE)("div",Js,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.decks,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:"deck-option",onClick:t=>l.selectAndLoadDeck(e.id)},(0,i.v_)(e.name),9,zs)))),128))])):((0,n.uX)(),(0,n.CE)("div",Us,[t[62]||(t[62]=(0,n.Lk)("p",null,"No decks available. Please create a deck first.",-1)),r.loading?((0,n.uX)(),(0,n.CE)("p",js,"Loading decks...")):(0,n.Q3)("",!0)]))])):(0,n.Q3)("",!0),"initialDraw"===r.phase?((0,n.uX)(),(0,n.CE)("div",Ks,[t[64]||(t[64]=(0,n.Lk)("h2",null,"Your Opening Hand",-1)),(0,n.Lk)("div",Ws,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.initialHand,((e,t)=>((0,n.uX)(),(0,n.CE)("div",{key:t,class:(0,i.C4)(["card-wrapper",{selected:r.selectedCards.includes(t)}]),onClick:e=>l.toggleCardSelect(t)},[(0,n.Lk)("img",{src:l.getCardImage(e),alt:e.name,class:"card-image",draggable:"false"},null,8,Vs)],10,qs)))),128))]),(0,n.Lk)("div",Gs,[(0,n.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>l.keepHand&&l.keepHand(...e)),class:"action-button keep"},"Keep"),(0,n.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>l.mulligan&&l.mulligan(...e)),class:"action-button mulligan"},"Mulligan"),(0,n.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>l.drawCard&&l.drawCard(...e)),class:"action-button draw"},"Draw")])])):(0,n.Q3)("",!0),"playtest"===r.phase?((0,n.uX)(),(0,n.CE)("div",Ys,[(0,n.Lk)("div",en,[(0,n.Lk)("div",{class:"command-zone",onDrop:t[5]||(t[5]=e=>l.dropCard(e,"command")),onDragover:t[6]||(t[6]=(0,s.D$)((()=>{}),["prevent"])),onClick:t[7]||(t[7]=e=>!r.isZoneExpanded.command&&l.toggleZoneExpansion("command"))},[(0,n.Lk)("div",tn,[t[65]||(t[65]=(0,n.Lk)("h3",null,"Command Zone",-1)),r.commandZone.some((e=>e.isCommander))?((0,n.uX)(),(0,n.CE)("div",an," Commander Tax: "+(0,i.v_)(r.commanderTax),1)):(0,n.Q3)("",!0)]),r.isZoneExpanded.command?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",sn,[r.commandZone.length>0?((0,n.uX)(),(0,n.CE)("div",nn,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.commandZone,((e,t)=>((0,n.uX)(),(0,n.CE)("div",{key:"command-preview-"+t,class:"card-wrapper"},[(0,n.Lk)("img",{src:l.getCardImage(e),alt:e.name,class:"card-image small",draggable:"true",onDragstart:a=>l.dragStart(a,e,"command",t),onContextmenu:(0,s.D$)((a=>l.openCardMenu(a,e,"command",t)),["prevent"])},null,40,on)])))),128))])):((0,n.uX)(),(0,n.CE)("div",rn," No commander "))])),r.isZoneExpanded.command?((0,n.uX)(),(0,n.CE)("div",ln,[(0,n.Lk)("div",cn,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.commandZone,((e,t)=>((0,n.uX)(),(0,n.CE)("div",{key:"command-expanded-"+t,class:"card-wrapper"},[(0,n.Lk)("img",{src:l.getCardImage(e),alt:e.name,class:"card-image",draggable:"true",onDragstart:a=>l.dragStart(a,e,"command",t),onContextmenu:(0,s.D$)((a=>l.openCardMenu(a,e,"command",t)),["prevent"])},null,40,dn)])))),128)),0===r.commandZone.length?((0,n.uX)(),(0,n.CE)("div",un," Command zone is empty. ")):(0,n.Q3)("",!0)]),(0,n.Lk)("button",{onClick:t[4]||(t[4]=(0,s.D$)((e=>l.toggleZoneExpansion("command")),["stop"])),class:"collapse-button"},"Collapse")])):(0,n.Q3)("",!0)],32),(0,n.Lk)("div",{class:"graveyard",onDrop:t[9]||(t[9]=e=>l.dropCard(e,"graveyard")),onDragover:t[10]||(t[10]=(0,s.D$)((()=>{}),["prevent"])),onClick:t[11]||(t[11]=e=>!r.isZoneExpanded.graveyard&&l.toggleZoneExpansion("graveyard"))},[(0,n.Lk)("h3",null,"Graveyard ("+(0,i.v_)(r.graveyard.length)+")",1),r.isZoneExpanded.graveyard?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",mn,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.graveyard.slice(0,3),((e,t)=>((0,n.uX)(),(0,n.CE)("div",{key:"graveyard-preview-"+t,class:"card-wrapper"},[(0,n.Lk)("img",{src:l.getCardImage(e),alt:e.name,class:"card-image small",draggable:"true",onDragstart:a=>l.dragStart(a,e,"graveyard",t),onContextmenu:(0,s.D$)((a=>l.openCardMenu(a,e,"graveyard",t)),["prevent"])},null,40,pn)])))),128)),r.graveyard.length>3?((0,n.uX)(),(0,n.CE)("div",hn," +"+(0,i.v_)(r.graveyard.length-3)+" more ",1)):(0,n.Q3)("",!0),0===r.graveyard.length?((0,n.uX)(),(0,n.CE)("div",kn," Graveyard is empty. ")):(0,n.Q3)("",!0)])),r.isZoneExpanded.graveyard?((0,n.uX)(),(0,n.CE)("div",gn,[(0,n.Lk)("div",Cn,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.graveyard,((e,t)=>((0,n.uX)(),(0,n.CE)("div",{key:"graveyard-expanded-"+t,class:"card-wrapper"},[(0,n.Lk)("img",{src:l.getCardImage(e),alt:e.name,class:"card-image",draggable:"true",onDragstart:a=>l.dragStart(a,e,"graveyard",t),onContextmenu:(0,s.D$)((a=>l.openCardMenu(a,e,"graveyard",t)),["prevent"])},null,40,vn)])))),128)),0===r.graveyard.length?((0,n.uX)(),(0,n.CE)("div",fn," Graveyard is empty. ")):(0,n.Q3)("",!0)]),(0,n.Lk)("button",{onClick:t[8]||(t[8]=(0,s.D$)((e=>l.toggleZoneExpansion("graveyard")),["stop"])),class:"collapse-button"},"Collapse")])):(0,n.Q3)("",!0)],32),(0,n.Lk)("div",{class:"exile-zone",onDrop:t[13]||(t[13]=e=>l.dropCard(e,"exile")),onDragover:t[14]||(t[14]=(0,s.D$)((()=>{}),["prevent"])),onClick:t[15]||(t[15]=e=>!r.isZoneExpanded.exile&&l.toggleZoneExpansion("exile"))},[(0,n.Lk)("h3",null,"Exile ("+(0,i.v_)(r.exileZone.length)+")",1),r.isZoneExpanded.exile?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",yn,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.exileZone.slice(0,3),((e,t)=>((0,n.uX)(),(0,n.CE)("div",{key:"exile-preview-"+t,class:"card-wrapper"},[(0,n.Lk)("img",{src:l.getCardImage(e),alt:e.name,class:"card-image small",draggable:"true",onDragstart:a=>l.dragStart(a,e,"exile",t),onContextmenu:(0,s.D$)((a=>l.openCardMenu(a,e,"exile",t)),["prevent"])},null,40,bn)])))),128)),r.exileZone.length>3?((0,n.uX)(),(0,n.CE)("div",Ln," +"+(0,i.v_)(r.exileZone.length-3)+" more ",1)):(0,n.Q3)("",!0),0===r.exileZone.length?((0,n.uX)(),(0,n.CE)("div",xn," Exile is empty. ")):(0,n.Q3)("",!0)])),r.isZoneExpanded.exile?((0,n.uX)(),(0,n.CE)("div",Dn,[(0,n.Lk)("div",wn,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.exileZone,((e,t)=>((0,n.uX)(),(0,n.CE)("div",{key:"exile-expanded-"+t,class:"card-wrapper"},[(0,n.Lk)("img",{src:l.getCardImage(e),alt:e.name,class:"card-image",draggable:"true",onDragstart:a=>l.dragStart(a,e,"exile",t),onContextmenu:(0,s.D$)((a=>l.openCardMenu(a,e,"exile",t)),["prevent"])},null,40,En)])))),128)),0===r.exileZone.length?((0,n.uX)(),(0,n.CE)("div",Sn," Exile is empty. ")):(0,n.Q3)("",!0)]),(0,n.Lk)("button",{onClick:t[12]||(t[12]=(0,s.D$)((e=>l.toggleZoneExpansion("exile")),["stop"])),class:"collapse-button"},"Collapse")])):(0,n.Q3)("",!0)],32)]),(0,n.Lk)("div",{class:"battlefield",onDrop:t[19]||(t[19]=e=>l.dropCard(e,"battlefield")),onDragover:t[20]||(t[20]=(0,s.D$)((()=>{}),["prevent"]))},[t[66]||(t[66]=(0,n.Lk)("h3",null,"Battlefield",-1)),(0,n.Lk)("div",In,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.battlefield,((e,a)=>((0,n.uX)(),(0,n.CE)("div",{key:"battlefield-"+(e.gameId||a),class:"battlefield-card",style:(0,i.Tr)({transform:e.tapped?"rotate(90deg)":"none",left:e.position?.x+"px",top:e.position?.y+"px",position:"absolute"}),onMousedown:t=>l.startDrag(t,e,a),onMouseup:t[16]||(t[16]=(...e)=>l.stopDrag&&l.stopDrag(...e)),onMousemove:t[17]||(t[17]=e=>r.throttledHandleDrag(e))},[(0,n.Lk)("img",{src:l.getCardImage(e),alt:e.name,class:"card-image",draggable:"true",onDragstart:t=>l.dragStart(t,e,"battlefield",a),onContextmenu:(0,s.D$)((t=>l.openCardMenu(t,e,"battlefield",a)),["prevent"])},null,40,_n),e.counters>0?((0,n.uX)(),(0,n.CE)("div",$n,(0,i.v_)(e.counters),1)):(0,n.Q3)("",!0),void 0!==e.power||void 0!==e.toughness?((0,n.uX)(),(0,n.CE)("div",Fn,(0,i.v_)(e.power??"?")+"/"+(0,i.v_)(e.toughness??"?"),1)):(0,n.Q3)("",!0)],44,Tn)))),128))]),(0,n.Lk)("button",{onClick:t[18]||(t[18]=(...e)=>l.addToken&&l.addToken(...e)),class:"token-button"},"Add Token")],32),(0,n.Lk)("div",Mn,[(0,n.Lk)("div",{class:"library",onDrop:t[23]||(t[23]=e=>l.dropCard(e,"library")),onDragover:t[24]||(t[24]=(0,s.D$)((()=>{}),["prevent"]))},[(0,n.Lk)("h3",null,"Library ("+(0,i.v_)(r.library.length)+")",1),(0,n.Lk)("img",{src:r.defaultCardBack,alt:"Library",class:"library-image",onClick:t[21]||(t[21]=(...e)=>l.searchLibrary&&l.searchLibrary(...e)),draggable:"false"},null,8,Xn),(0,n.Lk)("button",{onClick:t[22]||(t[22]=(...e)=>l.drawCard&&l.drawCard(...e)),class:"draw-button"},"Draw")],32),(0,n.Lk)("div",{class:"hand-zone",onDrop:t[25]||(t[25]=e=>l.dropCard(e,"hand")),onDragover:t[26]||(t[26]=(0,s.D$)((()=>{}),["prevent"]))},[(0,n.Lk)("h3",null,"Hand ("+(0,i.v_)(r.hand.length)+")",1),(0,n.Lk)("div",Pn,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.groupedHand,((e,t)=>((0,n.uX)(),(0,n.CE)("div",{key:"hand-"+(e.card.gameId||t),class:"card-wrapper"},[(0,n.Lk)("img",{src:l.getCardImage(e.card),alt:e.card.name,class:"card-image",draggable:"true",onDragstart:t=>l.dragStart(t,e.card,"hand",l.findCardIndexInHand(e.card)),onContextmenu:(0,s.D$)((t=>l.openCardMenu(t,e.card,"hand",l.findCardIndexInHand(e.card))),["prevent"])},null,40,On),e.count>1?((0,n.uX)(),(0,n.CE)("div",An,(0,i.v_)(e.count),1)):(0,n.Q3)("",!0)])))),128)),0===r.hand.length?((0,n.uX)(),(0,n.CE)("div",Qn," Hand is empty. ")):(0,n.Q3)("",!0)])],32)]),r.showContextMenu&&r.contextCard?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"context-menu",style:(0,i.Tr)({top:r.contextMenuPosition.y+"px",left:r.contextMenuPosition.x+"px"}),onClick:t[41]||(t[41]=(0,s.D$)((()=>{}),["stop"]))},["battlefield"!==r.contextZone?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"context-menu-item",onClick:t[27]||(t[27]=e=>l.moveToZone("battlefield"))},"Move to Battlefield")):(0,n.Q3)("",!0),"exile"!==r.contextZone?((0,n.uX)(),(0,n.CE)("div",{key:1,class:"context-menu-item",onClick:t[28]||(t[28]=e=>l.moveToZone("exile"))},"Move to Exile")):(0,n.Q3)("",!0),"graveyard"!==r.contextZone?((0,n.uX)(),(0,n.CE)("div",{key:2,class:"context-menu-item",onClick:t[29]||(t[29]=e=>l.moveToZone("graveyard"))},"Move to Graveyard")):(0,n.Q3)("",!0),"command"===r.contextZone||r.contextCard?.isToken?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",{key:3,class:"context-menu-item",onClick:t[30]||(t[30]=e=>l.moveToZone("command"))},"Move to Command Zone")),"hand"===r.contextZone||r.contextCard?.isToken?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",{key:4,class:"context-menu-item",onClick:t[31]||(t[31]=e=>l.moveToZone("hand"))},"Move to Hand")),"library"===r.contextZone||r.contextCard?.isToken?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",{key:5,class:"context-menu-item",onClick:t[32]||(t[32]=(...e)=>l.moveToTopOfLibrary&&l.moveToTopOfLibrary(...e))},"Put on Top of Library")),"library"===r.contextZone||r.contextCard?.isToken?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",{key:6,class:"context-menu-item",onClick:t[33]||(t[33]=(...e)=>l.moveToBottomOfLibrary&&l.moveToBottomOfLibrary(...e))},"Put on Bottom of Library")),r.contextCard?.isCommander?((0,n.uX)(),(0,n.CE)("div",{key:7,class:"context-menu-item",onClick:t[34]||(t[34]=(...e)=>l.increaseCommanderTax&&l.increaseCommanderTax(...e))},"Increase Commander Tax (+2)")):(0,n.Q3)("",!0),t[67]||(t[67]=(0,n.Lk)("div",{class:"context-menu-divider"},null,-1)),r.contextCard?.card_faces?.length>1?((0,n.uX)(),(0,n.CE)("div",{key:8,class:"context-menu-item",onClick:t[35]||(t[35]=(...e)=>l.flipCard&&l.flipCard(...e))},"Flip Card")):(0,n.Q3)("",!0),"battlefield"===r.contextZone?((0,n.uX)(),(0,n.CE)("div",{key:9,class:"context-menu-item",onClick:t[36]||(t[36]=(...e)=>l.tapCard&&l.tapCard(...e))},(0,i.v_)(r.contextCard.tapped?"Untap":"Tap"),1)):(0,n.Q3)("",!0),"battlefield"===r.contextZone?((0,n.uX)(),(0,n.CE)("div",{key:10,class:"context-menu-item",onClick:t[37]||(t[37]=(...e)=>l.addCounter&&l.addCounter(...e))},"Add Counter")):(0,n.Q3)("",!0),"battlefield"===r.contextZone&&r.contextCard?.counters>0?((0,n.uX)(),(0,n.CE)("div",{key:11,class:"context-menu-item",onClick:t[38]||(t[38]=(...e)=>l.removeCounter&&l.removeCounter(...e))},"Remove Counter")):(0,n.Q3)("",!0),"battlefield"===r.contextZone?((0,n.uX)(),(0,n.CE)("div",{key:12,class:"context-menu-item",onClick:t[39]||(t[39]=(...e)=>l.setPowerToughness&&l.setPowerToughness(...e))},"Set Power/Toughness")):(0,n.Q3)("",!0),"battlefield"===r.contextZone?((0,n.uX)(),(0,n.CE)("div",{key:13,class:"context-menu-item",onClick:t[40]||(t[40]=(...e)=>l.createTokenCopy&&l.createTokenCopy(...e))},"Create Token Copy")):(0,n.Q3)("",!0)],4)):(0,n.Q3)("",!0),r.showTokenModal?((0,n.uX)(),(0,n.CE)("div",{key:1,class:"modal-overlay",onClick:t[48]||(t[48]=(...e)=>l.cancelTokenCreation&&l.cancelTokenCreation(...e))},[(0,n.Lk)("div",{class:"modal-content token-modal",onClick:t[47]||(t[47]=(0,s.D$)((()=>{}),["stop"]))},[t[71]||(t[71]=(0,n.Lk)("h3",null,"Create Token",-1)),(0,n.Lk)("div",Zn,[(0,n.Lk)("label",null,[t[68]||(t[68]=(0,n.eW)(" Token Name: ")),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[42]||(t[42]=e=>r.tokenName=e),type:"text",placeholder:"E.g., Soldier, Goblin"},null,512),[[s.Jo,r.tokenName]])]),(0,n.Lk)("label",null,[t[69]||(t[69]=(0,n.eW)(" Quantity: ")),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[43]||(t[43]=e=>r.tokenQuantity=e),type:"number",min:"1",max:"100"},null,512),[[s.Jo,r.tokenQuantity,void 0,{number:!0}]])]),(0,n.Lk)("label",null,[t[70]||(t[70]=(0,n.eW)(" Image URL (optional): ")),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[44]||(t[44]=e=>r.tokenImageUrl=e),type:"text",placeholder:"Paste image URL"},null,512),[[s.Jo,r.tokenImageUrl]])]),(0,n.Lk)("div",Nn,[(0,n.Lk)("button",{onClick:t[45]||(t[45]=(...e)=>l.createToken&&l.createToken(...e)),class:"confirm-button"},"Create"),(0,n.Lk)("button",{onClick:t[46]||(t[46]=(...e)=>l.cancelTokenCreation&&l.cancelTokenCreation(...e)),class:"cancel-button"},"Cancel")])])])])):(0,n.Q3)("",!0),r.showPTModal?((0,n.uX)(),(0,n.CE)("div",{key:2,class:"modal-overlay",onClick:t[54]||(t[54]=(...e)=>l.cancelPT&&l.cancelPT(...e))},[(0,n.Lk)("div",{class:"modal-content pt-modal",onClick:t[53]||(t[53]=(0,s.D$)((()=>{}),["stop"]))},[(0,n.Lk)("h3",null,"Set Power/Toughness for "+(0,i.v_)(r.contextCard?.name),1),(0,n.Lk)("div",Rn,[(0,n.Lk)("label",null,[t[72]||(t[72]=(0,n.eW)(" Power: ")),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[49]||(t[49]=e=>r.newPower=e),type:"number"},null,512),[[s.Jo,r.newPower,void 0,{number:!0}]])]),(0,n.Lk)("label",null,[t[73]||(t[73]=(0,n.eW)(" Toughness: ")),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[50]||(t[50]=e=>r.newToughness=e),type:"number"},null,512),[[s.Jo,r.newToughness,void 0,{number:!0}]])]),(0,n.Lk)("div",Bn,[(0,n.Lk)("button",{onClick:t[51]||(t[51]=(...e)=>l.savePT&&l.savePT(...e)),class:"confirm-button"},"Save"),(0,n.Lk)("button",{onClick:t[52]||(t[52]=(...e)=>l.cancelPT&&l.cancelPT(...e)),class:"cancel-button"},"Cancel")])])])])):(0,n.Q3)("",!0),r.showLibrarySearch?((0,n.uX)(),(0,n.CE)("div",{key:3,class:"modal-overlay",onClick:t[60]||(t[60]=(...e)=>l.closeLibrarySearch&&l.closeLibrarySearch(...e))},[(0,n.Lk)("div",{class:"modal-content library-search-modal",onClick:t[59]||(t[59]=(0,s.D$)((()=>{}),["stop"]))},[(0,n.Lk)("h3",null,"Search Library ("+(0,i.v_)(r.library.length)+" cards)",1),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[55]||(t[55]=e=>r.librarySearchQuery=e),type:"text",placeholder:"Search for a card...",onInput:t[56]||(t[56]=(...e)=>l.searchLibraryCards&&l.searchLibraryCards(...e)),class:"library-search-input"},null,544),[[s.Jo,r.librarySearchQuery]]),(0,n.Lk)("div",Hn,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.librarySearchResults,(e=>((0,n.uX)(),(0,n.CE)("div",{key:"search-"+(e.gameId||e.id),class:"search-result-card",onClick:t=>l.moveSearchedCardToHand(e)},[(0,n.Lk)("img",{src:l.getCardImage(e),alt:e.name,class:"search-card-image"},null,8,jn),(0,n.Lk)("span",null,(0,i.v_)(e.name),1)],8,Un)))),128)),0===r.librarySearchResults.length&&r.librarySearchQuery?((0,n.uX)(),(0,n.CE)("div",Jn," No matching cards found. ")):(0,n.Q3)("",!0),0===r.librarySearchResults.length&&!r.librarySearchQuery&&r.library.length>0?((0,n.uX)(),(0,n.CE)("div",zn," Library contains "+(0,i.v_)(r.library.length)+" cards. (Showing in current library order) ",1)):(0,n.Q3)("",!0),0===r.library.length?((0,n.uX)(),(0,n.CE)("div",Kn," Library is empty. ")):(0,n.Q3)("",!0)]),(0,n.Lk)("div",Wn,[(0,n.Lk)("button",{onClick:t[57]||(t[57]=(...e)=>l.shuffleLibrary&&l.shuffleLibrary(...e)),class:"action-button mulligan"},"Shuffle Library"),(0,n.Lk)("button",{onClick:t[58]||(t[58]=(...e)=>l.closeLibrarySearch&&l.closeLibrarySearch(...e)),class:"cancel-button"},"Close")])])])):(0,n.Q3)("",!0)])):(0,n.Q3)("",!0)])):((0,n.uX)(),(0,n.CE)("div",qn," Loading... "))])}a(2577);function Gn(e,t){let a;return function(){const s=arguments,n=this;a||(e.apply(n,s),a=!0,setTimeout((()=>a=!1),t))}}var Yn={name:"PlaytestPopup",props:{decks:{type:Array,default:()=>[]}},data(){return{selectedDeckId:null,phase:"select",loading:!0,isInitialized:!1,library:[],initialHand:[],hand:[],battlefield:[],graveyard:[],exileZone:[],commandZone:[],selectedCards:[],isZoneExpanded:{command:!1,exile:!1,graveyard:!1},draggedCard:null,draggedFromZone:null,draggedFromIndex:null,isDraggingBattlefieldCard:!1,draggedBattlefieldCardIndex:-1,dragStartOffset:{x:0,y:0},throttledHandleDrag:null,showContextMenu:!1,contextMenuPosition:{x:0,y:0},contextCard:null,contextZone:null,contextIndex:null,contextMenuCloseHandler:null,showTokenModal:!1,tokenName:"",tokenQuantity:1,tokenImageUrl:"",showPTModal:!1,newPower:0,newToughness:0,showLibrarySearch:!1,librarySearchQuery:"",librarySearchResults:[],commanderTax:0,mulliganCount:0,defaultCardBack:new URL(a(8645),a.b).href,defaultTokenImage:new URL(a(2668),a.b).href}},computed:{groupedHand(){const e=[],t=new Map;return this.hand.forEach((a=>{const s=a.gameId||a.id||a.name;if(t.has(s))t.get(s).count++;else{const n={card:a,count:1};t.set(s,n),e.push(n)}})),e}},created(){this.throttledHandleDrag=Gn(this.handleDrag,16)},mounted(){console.log("PlaytestPopup mounted"),this.$nextTick((()=>{this.isInitialized=!0,this.loading=!1})),this.contextMenuCloseHandler=e=>{this.showContextMenu&&!e.target.closest(".context-menu")&&this.closeContextMenu()},document.addEventListener("click",this.contextMenuCloseHandler)},beforeUnmount(){console.log("PlaytestPopup unmounting"),document.removeEventListener("click",this.contextMenuCloseHandler),document.removeEventListener("mousemove",this.throttledHandleDrag),document.removeEventListener("mouseup",this.stopDrag),this.cleanup()},methods:{closePopup(){this.cleanup(),this.$emit("close")},cleanup(){console.log("Cleaning up PlaytestPopup state"),this.library=[],this.initialHand=[],this.hand=[],this.battlefield=[],this.graveyard=[],this.exileZone=[],this.commandZone=[],this.selectedCards=[],this.selectedDeckId=null,this.phase="select",this.commanderTax=0,this.mulliganCount=0,this.closeContextMenu(),this.showTokenModal=!1,this.showPTModal=!1,this.showLibrarySearch=!1,this.isZoneExpanded={command:!1,exile:!1,graveyard:!1},this.isDraggingBattlefieldCard=!1,this.draggedBattlefieldCardIndex=-1,this.draggedCard=null,this.draggedFromZone=null,this.draggedFromIndex=null},selectAndLoadDeck(e){this.selectedDeckId=e,this.loadDeck()},loadDeck(){try{if(!this.selectedDeckId)return void console.error("No deck selected");const e=this.decks.find((e=>e.id===this.selectedDeckId));if(!e)return void console.error("Selected deck not found:",this.selectedDeckId);console.log("Loading deck:",e.name),this.cleanup(),this.phase="loading";const t=JSON.parse(JSON.stringify(e)),a=[];t.cards&&Array.isArray(t.cards)?(t.cards.forEach(((e,s)=>{if(t.commander&&e.id===t.commander.id)return;const n=e.count||e.quantity||1;for(let t=0;t<n;t++)a.push({...e,gameId:`card-${e.id}-${s}-${t}-${Date.now()}`,tapped:!1,flipped:!1,counters:0,position:null,power:e.power,toughness:e.toughness})})),this.library=a,console.log(`Library initialized with ${this.library.length} cards. First few:`,this.library.slice(0,5).map((e=>e.name)))):(console.warn("Deck has no cards or cards is not an array:",t),this.library=[]),t.commander?this.commandZone=[{...t.commander,isCommander:!0,gameId:`commander-${t.commander.id}-${Date.now()}`,tapped:!1,flipped:!1,counters:0,position:null,power:t.commander.power,toughness:t.commander.toughness}]:this.commandZone=[],this.shuffleDeck(),this.drawInitialHand(),this.phase="initialDraw",console.log("Deck loaded:",{library:this.library.length,hand:this.initialHand.length,commander:this.commandZone.length})}catch(e){console.error("Error in loadDeck:",e),this.phase="select"}},drawInitialHand(){this.initialHand=[],this.selectedCards=[];const e=7;for(let t=0;t<e;t++){if(!(this.library.length>0)){console.warn("Library empty during initial draw");break}this.initialHand.push(this.library.pop())}},toggleCardSelect(e){const t=this.selectedCards.indexOf(e);-1===t?this.selectedCards.push(e):this.selectedCards.splice(t,1)},keepHand(){this.hand=[...this.initialHand],this.initialHand=[],this.phase="playtest"},mulligan(){this.mulliganCount++;const e=7;this.library.push(...this.initialHand),this.initialHand=[],this.shuffleDeck();for(let t=0;t<e;t++){if(!(this.library.length>0)){console.warn("Library empty during mulligan draw");break}this.initialHand.push(this.library.pop())}alert(`Mulligan ${this.mulliganCount}. Drawn ${this.initialHand.length} cards. You must manually put ${this.mulliganCount} card(s) on the bottom of your library using the context menu after keeping.`),this.phase="initialDraw",this.selectedCards=[]},drawCard(){if(this.library.length>0){const e=this.library.pop();"initialDraw"===this.phase?this.initialHand.push(e):"playtest"===this.phase&&this.hand.push(e)}else console.warn("Cannot draw, library is empty!")},shuffleDeck(){console.log("Shuffling deck. Library size:",this.library.length),this.library.length>1&&console.log("Library order BEFORE shuffle (top 5):",this.library.slice(-5).map((e=>e.name)));for(let e=this.library.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[this.library[e],this.library[t]]=[this.library[t],this.library[e]]}this.library.length>1&&console.log("Library order AFTER shuffle (top 5):",this.library.slice(-5).map((e=>e.name))),console.log("Deck shuffle complete.")},shuffleLibrary(){console.log("Attempting to shuffle library via button..."),this.shuffleDeck(),this.showLibrarySearch&&this.searchLibraryCards()},increaseCommanderTax(){this.commanderTax+=2,console.log(`Commander tax increased to ${this.commanderTax}`),this.closeContextMenu()},toggleZoneExpansion(e){Object.keys(this.isZoneExpanded).forEach((t=>{t!==e&&(this.isZoneExpanded[t]=!1)})),this.isZoneExpanded[e]=!this.isZoneExpanded[e],console.log(`Toggled ${e} expansion to:`,this.isZoneExpanded[e])},removeCardFromZone(e,t){const a=this.getZoneArray(e);return!a||t<0||t>=a.length?(console.error(`Cannot remove card from ${e} at invalid index ${t}`),null):a.splice(t,1)[0]},dragStart(e,t,a,s){console.log(`Drag Start: ${t.name} from ${a}[${s}]`),e.dataTransfer.setData("text/plain",JSON.stringify({cardId:t.gameId||t.id,zone:a,index:s})),e.dataTransfer.effectAllowed="move",this.draggedCard=t,this.draggedFromZone=a,this.draggedFromIndex=s},dropCard(e,t){e.preventDefault(),console.log(`Drop on: ${t}`);try{const a=JSON.parse(e.dataTransfer.getData("text/plain")),{cardId:s,zone:n}=a;let o;console.log(`Dropped card ID: ${s} from ${n} to ${t}`);let r=-1;const i=this.getZoneArray(n);if(!i)return void console.error("Invalid source zone:",n);if(r=i.findIndex((e=>(e.gameId||e.id)===s)),-1===r)return void console.error(`Card ${s} not found in source zone ${n}. Drag might be stale.`);if(o=i.splice(r,1)[0],!o)return void console.error("Failed to extract card from source zone.");if(o.isToken&&"battlefield"===n&&("hand"===t||"library"===t||"graveyard"===t||"exile"===t))return console.log(`Token ${o.name} removed (moved from battlefield to ${t})`),void(this.draggedCard=null);const l=this.getZoneArray(t);if(!l)return console.error("Invalid target zone:",t),void i.splice(r,0,o);if(o.tapped=!1,o.position=null,"battlefield"===t){const t=e.currentTarget.getBoundingClientRect();o.position={x:e.clientX-t.left,y:e.clientY-t.top},l.push(o)}else"library"===t?(l.push(o),console.log(`Moved ${o.name} to TOP of library via drop`)):l.push(o);console.log(`Moved ${o.name} from ${n} to ${t}`)}catch(a){console.error("Error processing drop event:",a)}finally{this.draggedCard=null,this.draggedFromZone=null,this.draggedFromIndex=null}},startDrag(e,t,a){if(0!==e.button)return;if(!e.target.closest(".battlefield-card"))return;console.log(`Battlefield Drag Start: ${t.name}`),this.isDraggingBattlefieldCard=!0,this.draggedBattlefieldCardIndex=a,t.position||(t.position={x:50,y:50});const s=e.target.closest(".battlefield-card").getBoundingClientRect();this.dragStartOffset={x:e.clientX-s.left,y:e.clientY-s.top},document.addEventListener("mousemove",this.throttledHandleDrag),document.addEventListener("mouseup",this.stopDrag),e.preventDefault()},handleDrag(e){if(!this.isDraggingBattlefieldCard||this.draggedBattlefieldCardIndex<0)return;const t=this.battlefield[this.draggedBattlefieldCardIndex];if(!t)return;const a=this.$el.querySelector(".battlefield-cards").getBoundingClientRect(),s=e.clientX-a.left-this.dragStartOffset.x,n=e.clientY-a.top-this.dragStartOffset.y;t.position={x:s,y:n}},stopDrag(){this.isDraggingBattlefieldCard&&(console.log(`Battlefield Drag End: ${this.battlefield[this.draggedBattlefieldCardIndex]?.name}`),this.isDraggingBattlefieldCard=!1,this.draggedBattlefieldCardIndex=-1,document.removeEventListener("mousemove",this.throttledHandleDrag),document.removeEventListener("mouseup",this.stopDrag))},openCardMenu(e,t,a,s){e.preventDefault(),e.stopPropagation();let n=s;const o=this.getZoneArray(a);if(!o)return void console.error(`Invalid zone ${a} for context menu`);if("hand"===a?n=this.findCardIndexInHand(t):(s>=o.length||(o[s].gameId||o[s].id)!==(t.gameId||t.id))&&(n=o.findIndex((e=>(e.gameId||e.id)===(t.gameId||t.id)))),-1===n)return void console.error(`Context menu card ${t.name} not found in ${a}`);this.contextCard=t,this.contextZone=a,this.contextIndex=n;const r=e.clientX,i=e.clientY,l=window.innerHeight,c=300,d=l-i,u=5;let m;d<c?(m=i-c-u,m<u&&(m=u)):m=i+u;const p=r+u;this.contextMenuPosition={x:p,y:m},this.showContextMenu=!0,console.log(`Context menu opened for ${t.name} in ${a}[${n}] at (${p}, ${m})`)},closeContextMenu(){this.showContextMenu=!1,this.contextCard=null,this.contextZone=null,this.contextIndex=null},moveCardFromContext(e,t="top"){const a=this.getCardFromContext();if(!a)return console.error("Cannot move card, context invalid or lost."),void this.closeContextMenu();const s=this.contextZone,n=this.contextIndex;if(a.isToken&&"battlefield"===s&&("hand"===e||"library"===e||"graveyard"===e||"exile"===e))return console.log(`Token ${a.name} removed (moved from ${s} to ${e})`),this.removeCardFromZone(s,n),void this.closeContextMenu();a.isCommander&&("graveyard"!==e&&"exile"!==e&&"hand"!==e&&"library"!==e||console.warn(`Commander ${a.name} moved to ${e}. In a real game, you could choose the Command Zone instead.`),"command"===e&&"command"!==s&&this.increaseCommanderTax());const o=this.removeCardFromZone(s,n);if(!o)return console.error(`Failed to remove ${a.name} from ${s}`),void this.closeContextMenu();const r=this.getZoneArray(e);if(!r)return console.error("Invalid target zone for move:",e),this.getZoneArray(s)?.splice(n,0,o),void this.closeContextMenu();o.tapped=!1,o.position=null,"battlefield"===e?(o.position={x:50,y:50},r.push(o)):"library"===e?"bottom"===t?(r.unshift(o),console.log(`Moved ${o.name} to BOTTOM of library`)):(r.push(o),console.log(`Moved ${o.name} to TOP of library`)):r.push(o),console.log(`Moved ${o.name} from ${s} to ${e}`),this.closeContextMenu()},moveToZone(e){this.moveCardFromContext(e)},moveToTopOfLibrary(){this.moveCardFromContext("library","top")},moveToBottomOfLibrary(){this.moveCardFromContext("library","bottom")},flipCard(){const e=this.getCardFromContext();e&&e.card_faces?.length>1&&(e.flipped=!e.flipped,console.log(`${e.name} flipped to ${e.flipped?"back":"front"}`)),this.closeContextMenu()},tapCard(){const e=this.getCardFromContext();e&&"battlefield"===this.contextZone&&(e.tapped=!e.tapped,console.log(`${e.name} ${e.tapped?"tapped":"untapped"}`)),this.closeContextMenu()},addCounter(){const e=this.getCardFromContext();e&&"battlefield"===this.contextZone&&(void 0!==e.counters&&null!==e.counters||(e.counters=0),e.counters++,console.log(`Added counter to ${e.name} (${e.counters} total)`)),this.closeContextMenu()},removeCounter(){const e=this.getCardFromContext();e&&"battlefield"===this.contextZone&&e.counters>0&&(e.counters--,console.log(`Removed counter from ${e.name} (${e.counters} total)`)),this.closeContextMenu()},setPowerToughness(){const e=this.getCardFromContext();e&&"battlefield"===this.contextZone?(this.newPower=e.power??"",this.newToughness=e.toughness??"",this.showPTModal=!0):this.closeContextMenu()},createTokenCopy(){const e=this.getCardFromContext();e&&"battlefield"===this.contextZone?(this.tokenName=`${e.name} Token`,this.tokenImageUrl=this.getCardImage(e),this.tokenQuantity=1,this.showTokenModal=!0):this.closeContextMenu()},addToken(){this.tokenName="",this.tokenQuantity=1,this.tokenImageUrl="",this.showTokenModal=!0},createToken(){const e=Math.max(1,Number(this.tokenQuantity)||1),t=this.tokenName.trim()||"Token",a=this.tokenImageUrl.trim()||this.defaultTokenImage;for(let s=0;s<e;s++){const e={name:t,isToken:!0,gameId:`token-${t.replace(/\s+/g,"-")}-${Date.now()}-${s}`,image_uris:{normal:a},tapped:!1,flipped:!1,counters:0,position:{x:50+10*s,y:50+10*s},power:void 0,toughness:void 0};this.battlefield.push(e)}console.log(`Created ${e} "${t}" token(s)`),this.cancelTokenCreation()},cancelTokenCreation(){this.showTokenModal=!1,this.closeContextMenu()},savePT(){const e=this.getCardFromContext();if(e&&"battlefield"===this.contextZone){const t=""===this.newPower?void 0:Number(this.newPower),a=""===this.newToughness?void 0:Number(this.newToughness);e.power=t,e.toughness=a,console.log(`Set P/T for ${e.name} to ${t??"?"}/${a??"?"}`)}else console.warn("Could not save P/T, context lost or invalid.");this.cancelPT()},cancelPT(){this.showPTModal=!1,this.closeContextMenu()},searchLibrary(){this.librarySearchQuery="",this.librarySearchResults=[...this.library].reverse(),this.showLibrarySearch=!0},searchLibraryCards(){const e=this.librarySearchQuery.toLowerCase().trim();this.librarySearchResults=e?this.library.filter((t=>t.name.toLowerCase().includes(e))).reverse():[...this.library].reverse()},moveSearchedCardToHand(e){const t=this.library.findIndex((t=>(t.gameId||t.id)===(e.gameId||e.id)));if(-1!==t){const[e]=this.library.splice(t,1);this.hand.push(e),console.log(`Moved "${e.name}" from library to hand.`),console.log("Shuffling library after search..."),this.shuffleDeck(),this.closeLibrarySearch()}else console.error(`Card "${e.name}" not found in library during search move.`)},closeLibrarySearch(){this.showLibrarySearch=!1,this.librarySearchQuery="",this.librarySearchResults=[]},getCardImage(e){if(!e)return this.defaultCardBack;try{if(e.flipped&&e.card_faces&&e.card_faces.length>1&&e.card_faces[1].image_uris)return e.card_faces[1].image_uris.normal||e.card_faces[1].image_uris.large||this.defaultCardBack;if(e.image_uris)return e.image_uris.normal||e.image_uris.large||this.defaultCardBack;if(e.card_faces&&e.card_faces.length>0&&e.card_faces[0].image_uris)return e.card_faces[0].image_uris.normal||e.card_faces[0].image_uris.large||this.defaultCardBack;if(e.isToken)return e.image_uris?.normal||this.defaultTokenImage}catch(t){console.error("Error getting card image for:",e?.name,t)}return console.warn("Using default card back for card:",e?.name),this.defaultCardBack},getZoneArray(e){switch(e){case"hand":return this.hand;case"library":return this.library;case"graveyard":return this.graveyard;case"exile":return this.exileZone;case"command":return this.commandZone;case"battlefield":return this.battlefield;case"initialDraw":return this.initialHand;default:return console.error(`Invalid zone name: ${e}`),null}},findCardIndexInHand(e){return e?this.hand.findIndex((t=>(t.gameId||t.id)===(e.gameId||e.id))):-1},getCardFromContext(){if(!this.contextZone||null===this.contextIndex||this.contextIndex<0)return null;const e=this.getZoneArray(this.contextZone);return!e||this.contextIndex>=e.length?(console.error(`Context index ${this.contextIndex} out of bounds for zone ${this.contextZone} (size ${e?.length})`),null):e[this.contextIndex]}}};const eo=(0,$.A)(Yn,[["render",Vn],["__scopeId","data-v-c1372b88"]]);var to=eo,ao={name:"DeckSidebar",components:{ImportPopup:$a,ExportPopup:Ua,StatsPopup:Zs,PlaytestPopup:to},props:{selectedCard:Object},data(){return{decks:[],activeDeck:null,showCreateDeckModal:!1,showCommanderSearch:!1,showAddLandsModal:!1,showDeleteConfirmation:!1,newDeckName:"",selectedCommander:null,commanderQuery:"",commanderResults:[],selectedLand:null,landCount:1,deckToDelete:null,firebaseStatus:"checking",lastSyncTime:null,connectionInterval:null,showImportModal:!1,showExportModal:!1,showStatsPopup:!1,showStatsModal:!1,isRenaming:!1,tempDeckName:"",showPlaytestPopup:!1,selectedDeckForPlaytest:null}},computed:{sortedCards(){return this.activeDeck?this.activeDeck.cards.slice().sort(((e,t)=>(e.cmc||0)-(t.cmc||0))):[]},totalCards(){return this.activeDeck?this.activeDeck.cards.reduce(((e,t)=>e+(t.count||1)),0):0},statusMessage(){return{checking:"Checking connection...",connected:"Connected to Cloud",disconnected:"Offline (using local storage)",error:"Connection error"}[this.firebaseStatus]},deckCardCounts(){return this.decks.reduce(((e,t)=>t&&t.cards?(e[t.id]=t.cards.reduce(((e,t)=>e+t.quantity),0),e):e),{})}},methods:{async checkConnection(){try{const e=Date.now();await da(),this.firebaseStatus="connected",this.lastSyncTime=new Date,console.log(`Firebase connection OK (${Date.now()-e}ms)`)}catch(e){this.firebaseStatus="disconnected",console.error("Firebase connection failed:",e)}},formatTime(e){return e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},async checkDataSource(){try{console.group("Data Source Debugging"),console.log("Testing Firebase connection...");const e=await da();console.log("Firebase response:",e);const t=localStorage.getItem("mtg-decks");return console.log("Local storage contents:",t?JSON.parse(t):"Empty"),console.log("Component decks state:",this.decks),console.groupEnd(),e&&e.length>0?alert(`Using Firebase (${e.length} decks found)`):t?alert("Using local storage (Firebase not available)"):alert("No decks found in either Firebase or local storage"),e?"firebase":"local"}catch(e){return console.error("Debug check failed:",e),alert("Debug check failed - check console for details"),"error"}},promptDeleteDeck(e){this.deckToDelete=e,this.showDeleteConfirmation=!0},async confirmDeleteDeck(){if(this.deckToDelete){try{await ua(this.deckToDelete.id);const e=this.decks.findIndex((e=>e.id===this.deckToDelete.id));-1!==e&&(this.decks.splice(e,1),localStorage.setItem("mtg-decks",JSON.stringify(this.decks)),this.activeDeck&&this.activeDeck.id===this.deckToDelete.id&&(this.activeDeck=null))}catch(e){console.error("Error deleting deck:",e);const t=this.decks.findIndex((e=>e.id===this.deckToDelete.id));-1!==t&&(this.decks.splice(t,1),localStorage.setItem("mtg-decks",JSON.stringify(this.decks)),this.activeDeck&&this.activeDeck.id===this.deckToDelete.id&&(this.activeDeck=null))}this.showDeleteConfirmation=!1,this.deckToDelete=null}},async handleDeckImport(e){const t={id:Date.now().toString(),name:e.name,commander:e.commander,colors:e.colors,cards:e.cards,created:e.created};try{await ca(t),this.decks.push(t),localStorage.setItem("mtg-decks",JSON.stringify(this.decks)),this.showImportModal=!1,this.loadDeck(t)}catch(a){console.error("Error importing deck:",a),this.decks.push(t),localStorage.setItem("mtg-decks",JSON.stringify(this.decks)),this.showImportModal=!1,this.loadDeck(t)}},async openPlaytest(e=null){try{console.log("Opening playtest with deck:",e),this.showPlaytestPopup=!1,await this.$nextTick(),await this.loadDecksFromStorage(),console.log("Decks loaded for playtest:",this.decks.length),this.selectedDeckForPlaytest=e,this.showPlaytestPopup=!0}catch(t){console.error("Error opening playtest:",t),this.showPlaytestPopup=!1}},getCardBorderStyle(e){const t=e.color_identity||[];if(0===t.length)return"background: rgba(200, 200, 200, 0.1)";if(1===t.length){const e={W:"rgba(248, 231, 185, 0.3)",U:"rgba(179, 206, 234, 0.3)",B:"rgba(136, 135, 135, 0.3)",R:"rgba(235, 159, 130, 0.3)",G:"rgba(196, 211, 202, 0.3)"};return`background: linear-gradient(to right, ${e[t[0]]}, transparent)`}const a=t.map(((e,a)=>{const s={W:"rgba(248, 231, 185, 0.3)",U:"rgba(179, 206, 234, 0.3)",B:"rgba(135, 135, 135, 0.3)",R:"rgba(235, 159, 130, 0.3)",G:"rgba(196, 211, 202, 0.3)"},n=a/t.length*100;return`${s[e]} ${n}%`})).join(", ");return`background: linear-gradient(135deg, ${a}, transparent 90%)`},canHaveMultipleCopies(e){const t=/basic (snow )?land/i.test(e.type_line),a=e.oracle_text?.toLowerCase().includes("a deck can have any number of cards named");return t||a},isColorIdentityValid(e){if(!this.activeDeck?.commander)return!0;const t=this.activeDeck.commander.color_identity||[],a=e.color_identity||[];return!(0!==a.length||!e.type_line?.toLowerCase().includes("land"))||a.every((e=>t.includes(e)))},isLegalInCommander(e){if("banned"===e.legalities?.commander)return!1;const t=["unf","ugl","unh","ust","und"];return!t.includes(e.set?.toLowerCase())&&("silver"!==e.border_color&&!e.frame_effects?.includes("acorn"))},formatColors(e){return e&&0!==e.length?e.map((e=>`<span class="mana small s${e.toLowerCase()}"></span>`)).join(" "):'<span class="mana small sc"></span>'},formatManaCost(e){return e?e.replace(/\{([^}]+)\}/g,((e,t)=>{let a=t.toLowerCase();return"t"!==a&&"tap"!==a||(a="t"),"q"!==a&&"untap"!==a||(a="q"),a.includes("/")&&(a=a.replace("/","")),/^\d+$/.test(a)&&(a=a.padStart(2,"0").slice(-2)),`<span class="mana small s${a}"></span>`})):""},loadDeck(e){this.activeDeck=JSON.parse(JSON.stringify(e))},backToDecks(){this.activeDeck=null},viewCardDetails(e){this.$emit("view-card",e)},addCardToDeck(e){if(!this.activeDeck)return alert("Please select a deck first!"),!1;if(!this.isColorIdentityValid(e))return alert(`❌ This card (${e.name}) doesn't match your commander's color identity!`),!1;if(!this.isLegalInCommander(e)){const t=confirm(`⚠️ "${e.name}" is not legal in Commander (banned/unserious set). Add anyway?`);if(!t)return!1}const t=this.activeDeck.cards.findIndex((t=>t.id===e.id));if(t>=0)this.canHaveMultipleCopies(e)?this.activeDeck.cards[t].count?this.activeDeck.cards[t].count++:this.activeDeck.cards[t].count=2:alert("This non-land card is already in your deck (max 1 copy).");else{const t=JSON.parse(JSON.stringify(e));this.activeDeck.cards.push(t)}this.$forceUpdate()},addOneCard(e,t){const a=this.activeDeck.cards.findIndex((t=>t.id===e.id));if(-1!==a&&this.canHaveMultipleCopies(e)&&(this.activeDeck.cards[a].count?this.activeDeck.cards[a].count++:this.activeDeck.cards[a].count=2,t)){const e=t.target.closest(".deck-card");e&&(e.classList.add("card-added"),setTimeout((()=>e.classList.remove("card-added")),300))}},removeCard(e){const t=this.activeDeck.cards.findIndex((t=>t.id===e.id));-1!==t&&(e.count&&e.count>1?this.activeDeck.cards[t].count--:this.activeDeck.cards.splice(t,1))},async searchCommanderCards(){if(this.showCommanderSearch=!0,this.commanderQuery.length<2)return void(this.commanderResults=[]);const e=encodeURIComponent(`${this.commanderQuery} type:legendary type:creature`);try{const t=await fetch(`https://api.scryfall.com/cards/search?q=${e}`),a=await t.json();this.commanderResults=a.data||[]}catch(t){console.error("Commander search failed:",t),this.commanderResults=[]}},selectCommander(e){this.selectedCommander=e,this.showCommanderSearch=!1},async createDeck(){if(this.newDeckName&&this.selectedCommander){const t={id:Date.now().toString(),name:this.newDeckName,commander:this.selectedCommander,colors:this.selectedCommander.color_identity||[],cards:[this.selectedCommander],created:(new Date).toISOString()};try{await ca(t),this.decks.push(t),localStorage.setItem("mtg-decks",JSON.stringify(this.decks)),this.newDeckName="",this.selectedCommander=null,this.showCreateDeckModal=!1,this.loadDeck(t)}catch(e){console.error("Error saving deck:",e),this.decks.push(t),localStorage.setItem("mtg-decks",JSON.stringify(this.decks)),this.newDeckName="",this.selectedCommander=null,this.showCreateDeckModal=!1,this.loadDeck(t)}}},async saveDeck(){const e=this.decks.findIndex((e=>e.id===this.activeDeck.id));if(-1!==e)try{this.firebaseStatus="checking",await ca(this.activeDeck),this.decks[e]=JSON.parse(JSON.stringify(this.activeDeck)),this.firebaseStatus="connected",this.lastSyncTime=new Date}catch(t){this.firebaseStatus="disconnected",localStorage.setItem("mtg-decks",JSON.stringify(this.decks))}},async loadDecksFromStorage(){try{this.firebaseStatus="checking";const e=await da();if(e&&e.length>0)this.decks=e,this.firebaseStatus="connected",this.lastSyncTime=new Date;else{const e=localStorage.getItem("mtg-decks");e&&(this.decks=JSON.parse(e),this.firebaseStatus="disconnected")}}catch(e){this.firebaseStatus="error";const t=localStorage.getItem("mtg-decks");t&&(this.decks=JSON.parse(t))}},startRenaming(){this.tempDeckName=this.activeDeck.name,this.isRenaming=!0,this.$nextTick((()=>{this.$refs.renameInput.focus()}))},cancelRenaming(){this.isRenaming=!1},confirmRenaming(){this.tempDeckName.trim()&&(this.activeDeck.name=this.tempDeckName.trim(),this.isRenaming=!1,this.saveDeck())},handleDeckExport(e){console.log("Exporting deck in format:",e),this.showExportModal=!1},showDeckStats(){this.activeDeck?this.showStatsModal=!0:console.warn("No active deck to show stats for")},getDeckCardCount(e){return e&&e.cards?e.cards.reduce(((e,t)=>e+(t.count||1)),0):0},toggleStatsPopup(){this.showStatsPopup=!this.showStatsPopup}},mounted(){this.loadDecksFromStorage(),this.connectionInterval=setInterval(this.checkConnection,3e4)},beforeUnmount(){clearInterval(this.connectionInterval)}};const so=(0,$.A)(ao,[["render",sa],["__scopeId","data-v-08cd79c7"]]);var no=so,oo=a(726),ro={components:{CardAutocomplete:M,CardGrid:B,CardDetailsPopup:ye,FilterPopup:at,DeckSidebar:no},data(){return{showFilterPopup:!1,query:"",results:[],cards:[],selectedCard:null,selectedCardForDeck:null,page:1,hasMore:!1,hasSearched:!1,allSets:[],activeFilters:{sets:[],rarities:[],types:[],supertypes:[],colors:[],manaCost:{min:0,max:20},power:{operator:"=",value:null},toughness:{operator:"=",value:null},DeckmoorLogo:oo}}},created(){this.fetchSets()},methods:{debouncedSearch:D()((function(){this.query.trim()?this.fetchAutocomplete(this.query):this.results=[]}),300),async fetchAutocomplete(e){try{const t=await L.A.get(`http://127.0.0.1:8000/search?query=${e}&page=1`);this.results=t.data.cards?.slice(0,10)||[]}catch(t){console.error("Error fetching autocomplete results:",t),this.results=[]}},async submitSearch(){this.hasSearched=!0,this.page=1,this.fetchCards(1)},async fetchCards(e=1){try{const t={page:e,query:this.query.trim(),colors:this.activeFilters.colors.join(","),mana_min:this.activeFilters.manaCost?.min||0,mana_max:this.activeFilters.manaCost?.max||20};this.activeFilters&&(this.activeFilters.sets.length>0&&(t.sets=this.activeFilters.sets.join(",")),this.activeFilters.rarities.length>0&&(t.rarities=this.activeFilters.rarities.join(",")),this.activeFilters.types.length>0&&(t.types=this.activeFilters.types.join(",")),this.activeFilters.supertypes.length>0&&(t.supertypes=this.activeFilters.supertypes.join(",")),null!==this.activeFilters.power.value&&(t.power_value=this.activeFilters.power.value,t.power_operator=this.activeFilters.power.operator),null!==this.activeFilters.toughness.value&&(t.toughness_value=this.activeFilters.toughness.value,t.toughness_operator=this.activeFilters.toughness.operator));const a=await L.A.get("http://127.0.0.1:8000/search",{params:t});this.cards=a.data.cards||[],this.hasMore=a.data.has_more||!1,this.page=e}catch(t){console.error("Error fetching cards:",t),this.cards=[],this.hasMore=!1}},showCardDetails(e){this.selectedCard=e,this.results=[]},applyFilters(e){this.activeFilters=e,this.page=1,this.fetchCards(1)},handleApplyFilters(e){this.activeFilters=e,this.page=1,this.fetchCards(1)},clearFilters(){this.activeFilters={sets:[],rarities:[],types:[],supertypes:[],colors:[],manaCost:{min:0,max:20},power:{operator:"=",value:null},toughness:{operator:"=",value:null}},this.page=1,this.fetchCards(1)},async fetchSets(){try{const e=await L.A.get("http://127.0.0.1:8000/sets");this.allSets=e.data.sets||[]}catch(e){console.error("Error fetching sets:",e),this.allSets=[]}},addCardToDeck(e){console.log("Adding card to deck:",e.name),this.$refs.deckSidebar?.addCardToDeck?this.$refs.deckSidebar.addCardToDeck(e):console.error("DeckSidebar not available")},onDeckSaved(){}}};const io=(0,$.A)(ro,[["render",b],["__scopeId","data-v-39f4df0a"]]);var lo=io,co={components:{CardSearch:lo}};const uo=(0,$.A)(co,[["render",r]]);var mo=uo,po=a(8875);const ho=(0,s.Ef)(mo);ho.use(po.Ay),(0,s.Ef)(mo).mount("#app")},8645:function(e,t,a){e.exports=a.p+"img/mtg-card-back.f1a6d1ca.jpg"},2668:function(e,t,a){e.exports=a.p+"img/mtg-token-default.d4b5011d.jpg"},6526:function(e,t,a){e.exports=a.p+"img/common.190d6a7b.png"},9905:function(e,t,a){e.exports=a.p+"img/masterpiece.5133d192.png"},4951:function(e,t,a){e.exports=a.p+"img/mythic.927a3cee.png"},2377:function(e,t,a){e.exports=a.p+"img/rare.82e2e6a4.png"},311:function(e,t,a){e.exports=a.p+"img/timeshifted.8e9642c6.png"},9767:function(e,t,a){e.exports=a.p+"img/uncommon.6555497b.png"},726:function(e,t,a){e.exports=a.p+"img/logo1.7a69d06c.png"}},t={};function a(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s].call(o.exports,o,o.exports,a),o.exports}a.m=e,function(){var e=[];a.O=function(t,s,n,o){if(!s){var r=1/0;for(d=0;d<e.length;d++){s=e[d][0],n=e[d][1],o=e[d][2];for(var i=!0,l=0;l<s.length;l++)(!1&o||r>=o)&&Object.keys(a.O).every((function(e){return a.O[e](s[l])}))?s.splice(l--,1):(i=!1,o<r&&(r=o));if(i){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[s,n,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/"}(),function(){a.b=document.baseURI||self.location.href;var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,o,r=s[0],i=s[1],l=s[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(n in i)a.o(i,n)&&(a.m[n]=i[n]);if(l)var d=l(a)}for(t&&t(s);c<r.length;c++)o=r[c],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(d)},s=self["webpackChunkmtg_frontend"]=self["webpackChunkmtg_frontend"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[504],(function(){return a(719)}));s=a.O(s)})();
//# sourceMappingURL=app.8368caa5.js.map